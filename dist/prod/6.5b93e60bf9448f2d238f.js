(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{j8gQ:function(e,t,i){"use strict";i.r(t),i.d(t,"AppoinmentModule",(function(){return nt}));var c=i("ofXK"),o=i("tyNb");let s=(()=>{class e{}return e.BKG_CAN="Booking Cancelled",e.BKG_CNF="Booking Confirmed",e.BKG_PROG="Booking Progress",e.BKG_CMPLT="Booking Completed",e.all="All",e.list=[e.BKG_CAN,e.BKG_CNF,e.BKG_PROG,e.BKG_CMPLT,e.all],e})();var a=i("zViY"),n=i("2cce"),r=i("0IaG"),l=i("SXVO"),d=i("fXoL"),h=i("6xPc"),f=i("jKJn"),m=i("bTqV");let u=(()=>{class e{constructor(e,t,i,c){this.dialogRef=e,this.row=t,this.manageGridService=i,this.alertService=c}ngOnInit(){this.row.data&&this.row.data.bookingStatus==s.BKG_CMPLT&&(this.alertService.open(l.a.ERROR,"Booking already Completed."),this.dialogRef.close())}deleteRowData(){this.row&&this.manageGridService.deleteRowData(a.a.appointment.key,{bookingId:this.row.data.bookingId}).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.dialogRef.close({action:"Delete"}),this.alertService.open(l.a.SUCCESS,e.result.data))},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(r.g),d.Zb(r.a),d.Zb(h.a),d.Zb(f.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-cancel"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(d.fc(0,"h1",0),d.Yc(1,"Confirmation"),d.ec(),d.fc(2,"mat-dialog-content"),d.fc(3,"p"),d.Yc(4,"Do you want to cancel this appointment?"),d.ec(),d.ec(),d.fc(5,"div",1),d.fc(6,"button",2),d.oc("click",(function(){return t.deleteRowData()})),d.Yc(7,"Yes"),d.ec(),d.fc(8,"button",3),d.Yc(9,"No"),d.ec(),d.ec()),2&e&&(d.Nb(8),d.Ac("mat-dialog-close","NO"))},directives:[r.h,r.e,r.c,m.a,r.d],styles:[""]}),e})();var g=i("dzPw");let p=(()=>{class e{constructor(e,t,i,c,o){this.dialogRef=e,this.row=t,this.manageGridService=i,this.alertService=c,this.adminBaseService=o}ngOnInit(){this.row.data&&this.row.data.bookingStatus==s.BKG_CMPLT&&(this.alertService.open(l.a.ERROR,"Booking already Completed."),this.dialogRef.close())}deleteRowData(){this.row&&this.adminBaseService.requestSubmit("ADM_UPDATE_BOOKING_COMPLETED",{bookingId:this.row.data.bookingId}).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.alertService.open(l.a.SUCCESS,"Appoinment completed successfully."),this.dialogRef.close({action:"Reload"}))},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(r.g),d.Zb(r.a),d.Zb(h.a),d.Zb(f.a),d.Zb(g.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-completed"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(d.fc(0,"h1",0),d.Yc(1,"Confirmation"),d.ec(),d.fc(2,"mat-dialog-content"),d.fc(3,"p"),d.Yc(4,"Do you want to complete this appointment?"),d.ec(),d.ec(),d.fc(5,"div",1),d.fc(6,"button",2),d.oc("click",(function(){return t.deleteRowData()})),d.Yc(7,"Yes"),d.ec(),d.fc(8,"button",3),d.Yc(9,"No"),d.ec(),d.ec()),2&e&&(d.Nb(8),d.Ac("mat-dialog-close","NO"))},directives:[r.h,r.e,r.c,m.a,r.d],styles:[""]}),e})();var v=i("XiUz"),b=i("MutI"),S=i("f0Cb");let N=(()=>{class e{constructor(e,t){this.dialogRef=e,this.row=t}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(r.g),d.Zb(r.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-details"]],decls:72,vars:11,consts:[[1,""],["mat-dialog-title","",1,"w-100","m-r-auto","dialog-title-h1"],["fxLayout","row","fxFill",""],["fxFlex","50",1,"m-r-5"],[1,"m-y-10"],[1,"w-100","f-medium","d-block","m-b-5","o-50"],[1,"w-100","font-weight-bold"],["fxFlex","50"],["mat-dialog-actions",""],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(d.fc(0,"header",0),d.fc(1,"h1",1),d.Yc(2,"Appoinment Details"),d.ec(),d.ec(),d.fc(3,"mat-dialog-content"),d.fc(4,"div",2),d.fc(5,"div",3),d.fc(6,"mat-list"),d.fc(7,"mat-list-item"),d.fc(8,"div",4),d.fc(9,"small",5),d.Yc(10,"Booking Number :"),d.ec(),d.fc(11,"div",6),d.Yc(12),d.ec(),d.ec(),d.ec(),d.fc(13,"mat-list-item"),d.fc(14,"div",4),d.fc(15,"small",5),d.Yc(16,"Booking Status :"),d.ec(),d.fc(17,"div",6),d.Yc(18),d.ec(),d.ec(),d.ec(),d.ac(19,"mat-divider"),d.fc(20,"mat-list-item"),d.fc(21,"div",4),d.fc(22,"small",5),d.Yc(23,"Booking Date :"),d.ec(),d.fc(24,"div",6),d.Yc(25),d.ec(),d.ec(),d.ec(),d.ac(26,"mat-divider"),d.fc(27,"mat-list-item"),d.fc(28,"div",4),d.fc(29,"small",5),d.Yc(30,"Time :"),d.ec(),d.fc(31,"div",6),d.Yc(32),d.ec(),d.ec(),d.ec(),d.ac(33,"mat-divider"),d.fc(34,"mat-list-item"),d.fc(35,"div",4),d.fc(36,"small",5),d.Yc(37,"Service :"),d.ec(),d.fc(38,"div",6),d.Yc(39),d.ec(),d.ec(),d.ec(),d.ac(40,"mat-divider"),d.fc(41,"mat-list-item"),d.fc(42,"div",4),d.fc(43,"small",5),d.Yc(44,"Service Person :"),d.ec(),d.fc(45,"div",6),d.Yc(46),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.fc(47,"div",7),d.fc(48,"mat-list"),d.fc(49,"mat-list-item"),d.fc(50,"div",4),d.fc(51,"small",5),d.Yc(52,"Name :"),d.ec(),d.fc(53,"div",6),d.Yc(54),d.ec(),d.ec(),d.ec(),d.ac(55,"mat-divider"),d.fc(56,"mat-list-item"),d.fc(57,"div",4),d.fc(58,"small",5),d.Yc(59,"Mob Number :"),d.ec(),d.fc(60,"div",6),d.Yc(61),d.ec(),d.ec(),d.ec(),d.ac(62,"mat-divider"),d.fc(63,"mat-list-item"),d.fc(64,"div",4),d.fc(65,"small",5),d.Yc(66,"Email :"),d.ec(),d.fc(67,"div",6),d.Yc(68),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.fc(69,"div",8),d.fc(70,"button",9),d.Yc(71,"Close"),d.ec(),d.ec()),2&e&&(d.Nb(12),d.Zc(t.row.data.bookingNumber),d.Nb(6),d.Zc(t.row.data.bookingStatus),d.Nb(7),d.Zc(t.row.data.bookingDate),d.Nb(7),d.bd("",t.row.data.bookingStartTime," - ",t.row.data.bookingEndTime," "),d.Nb(7),d.Zc(t.row.data.serviceMappingBean.services.serviceName),d.Nb(7),d.ad(" ",t.row.data.branchServicePerson.servicePersonDisplayName," "),d.Nb(8),d.Zc(t.row.data.guestUserMobile?t.row.data.guestUserName+" (Guest)":t.row.data.users.fullName),d.Nb(7),d.ad(" ",t.row.data.guestUserMobile?t.row.data.guestUserMobile:t.row.data.users.mobileNo,""),d.Nb(7),d.Zc(t.row.data.guestUserMobile?"Not Available":t.row.data.users?t.row.data.users.email:"Not Available"),d.Nb(2),d.Ac("mat-dialog-close","NO"))},directives:[r.h,r.e,v.c,v.d,v.a,b.a,b.c,S.a,r.c,m.a,r.d],styles:[""]}),e})();var C=i("XOzN"),k=i("mL9m"),M=i("y8gV"),A=i("oUVn"),B=i("kmnG"),w=i("d3UM"),P=i("3Pt+"),I=i("FKr1"),D=i("qFsG");function Y(e,t){if(1&e&&(d.fc(0,"mat-option",9),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e),d.Nb(1),d.ad("",e," ")}}function y(e,t){if(1&e&&(d.fc(0,"mat-option",9),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.merchantId),d.Nb(1),d.ad("",e.merchantName," ")}}function O(e,t){if(1&e&&(d.fc(0,"mat-option",9),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.branchId),d.Nb(1),d.ad("",e.branchName," ")}}function T(e,t){if(1&e&&(d.fc(0,"mat-option",9),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.serviceMappingId),d.Nb(1),d.ad("",e.services.serviceName," ")}}function L(e,t){if(1&e&&(d.fc(0,"mat-option",9),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.value),d.Nb(1),d.ad("",e.Display," ")}}function _(e,t){if(1&e){const e=d.gc();d.fc(0,"mat-form-field",10),d.fc(1,"input",11),d.oc("ngModelChange",(function(t){return d.Nc(e),d.sc().selectedSearchValue=t})),d.ec(),d.ec()}if(2&e){const e=d.sc();d.Nb(1),d.Ac("ngModel",e.selectedSearchValue)}}function E(e,t){if(1&e){const e=d.gc();d.fc(0,"button",12),d.oc("click",(function(t){return d.Nc(e),d.sc().onSearch(t)})),d.Yc(1,"Seach"),d.ec()}}function x(e,t){if(1&e){const e=d.gc();d.fc(0,"button",13),d.oc("click",(function(t){return d.Nc(e),d.sc().onClear(t)})),d.Yc(1,"Clear"),d.ec()}}let F=(()=>{class e{constructor(e,t,i,c,o,a){this.headerService=e,this.adminBaseService=t,this.manageGridService=i,this.dropDownService=c,this.authService=o,this.commonService=a,this.merchantList=[],this.branchList=[],this.serviceList=[],this.selectedStatus=s.BKG_CNF,this.subscriptions=[],this.searchBy=[{Display:"Booking Number",value:"BN"},{Display:"Customer Mobile Number",value:"CM"},{Display:"Customer Email",value:"CE"},{Display:"Customer Name",value:"CN"}],this.selectedSearchBy=null,this.selectedSearchValue=null}ngOnInit(){this.headerService.toggleSpinner(!0),this.subscriptions.push(this.dropDownService.getMerchant("ADM_LIST_MERCHANTS",null).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.merchantList=e.result.data),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}merchantSelectionChange(e){if(this.branchList=[],this.serviceList=[],this.selectedBranch=null,this.selectedService=null,e){this.manageGridService.loadFilters$.next(`serviceMappingBean.branch.merchantBean.merchantId==${e}##bookingStatus==${this.selectedStatus}`);const t={filter:"merchantBean.merchantId=="+e};this.headerService.toggleSpinner(!0),this.subscriptions.push(this.dropDownService.getBranch("ADM_LIST_MERCHANT_BRANCHES",t.filter).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.branchList=e.result.data),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}}branchSelectionChange(e){if(e){this.selectedService=null,this.manageGridService.loadFilters$.next(`serviceMappingBean.branch.branchId==${e}##bookingStatus==${this.selectedStatus}`);const t={filter:"branch.branchId=="+e};this.headerService.toggleSpinner(!0),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_SERVICE_MAPPING",t).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.serviceList=e.result.data)},e=>{this.headerService.toggleSpinner(!1)}))}}serviceSelectionChange(e){e&&this.manageGridService.loadFilters$.next(`serviceMappingBean.serviceMappingId==${e}##bookingStatus==${this.selectedStatus}`)}get getBookingStatusText(){return s}statusChange(e){if(e){this.manageGridService.loadFilters$.next("CLEAR");let t=null;if(this.authService.userInfo){const i=this.authService.userInfo;(i.userRole.roleName.toUpperCase()===n.a.merchantAdmin||i.userRole.roleName.toUpperCase()===n.a.branchAdmin)&&(t="serviceMappingBean.branch.merchantBean.merchantId=="+i.merchant.merchantId),this.manageGridService.loadFilters$.next(e==this.getBookingStatusText.all?`${t}##bookingStatus==${this.getBookingStatusText.BKG_CAN}##bookingStatus==${this.getBookingStatusText.BKG_CNF}##bookingStatus==${this.getBookingStatusText.BKG_PROG}##bookingStatus==${this.getBookingStatusText.BKG_CMPLT}`:`${t}##bookingStatus==${e}`)}}}onSearch(e){this.selectedSearchBy&&this.selectedSearchValue&&("CM"==this.selectedSearchBy?this.manageGridService.loadFilters$.next(`users.mobileNo==${this.commonService.encrypt(this.selectedSearchValue)}##bookingStatus==${this.selectedStatus}`):"CE"==this.selectedSearchBy?this.manageGridService.loadFilters$.next(`users.email==${this.commonService.encrypt(this.selectedSearchValue)}##bookingStatus==${this.selectedStatus}`):"CN"==this.selectedSearchBy?this.manageGridService.loadFilters$.next(`users.fullName==${this.selectedSearchValue}##bookingStatus==${this.selectedStatus}`):"BN"==this.selectedSearchBy&&this.manageGridService.loadFilters$.next(`bookingNumber==${this.selectedSearchValue}##bookingStatus==${this.selectedStatus}`))}onClear(e){this.selectedSearchValue=null,this.selectedMerchant=null,this.selectedBranch=null,this.selectedService=null,this.manageGridService.loadFilters$.next("bookingStatus=="+this.selectedStatus)}searchByChange(){this.selectedSearchValue=null}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(C.a),d.Zb(g.a),d.Zb(h.a),d.Zb(k.a),d.Zb(M.a),d.Zb(A.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-filter"]],decls:37,vars:13,consts:[["fxLayout","row","fxFill",""],["fxFlex","25"],["appearance","fill",1,"full-width-80"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","25",1,"p-t-10"],["color","accent","class","full-width",4,"ngIf"],["mat-raised-button","","type","submit","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","type","submit","color","primary","class","m-l-5",3,"click",4,"ngIf"],[3,"value"],["color","accent",1,"full-width"],["matInput","","placeholder","Search here","autocomplete","off",3,"ngModel","ngModelChange"],["mat-raised-button","","type","submit","color","primary",3,"click"],["mat-raised-button","","type","submit","color","primary",1,"m-l-5",3,"click"]],template:function(e,t){1&e&&(d.fc(0,"div",0),d.fc(1,"div",1),d.fc(2,"mat-form-field",2),d.fc(3,"mat-label"),d.Yc(4,"Status"),d.ec(),d.fc(5,"mat-select",3),d.oc("ngModelChange",(function(e){return t.selectedStatus=e}))("selectionChange",(function(e){return t.statusChange(e.value)})),d.Wc(6,Y,2,2,"mat-option",4),d.ec(),d.ec(),d.ec(),d.fc(7,"div",1),d.fc(8,"mat-form-field",2),d.fc(9,"mat-label"),d.Yc(10,"Choose Merchant"),d.ec(),d.fc(11,"mat-select",3),d.oc("ngModelChange",(function(e){return t.selectedMerchant=e}))("selectionChange",(function(e){return t.merchantSelectionChange(e.value)})),d.Wc(12,y,2,2,"mat-option",4),d.ec(),d.ec(),d.ec(),d.fc(13,"div",1),d.fc(14,"mat-form-field",2),d.fc(15,"mat-label"),d.Yc(16,"Choose Branch"),d.ec(),d.fc(17,"mat-select",3),d.oc("ngModelChange",(function(e){return t.selectedBranch=e}))("selectionChange",(function(e){return t.branchSelectionChange(e.value)})),d.Wc(18,O,2,2,"mat-option",4),d.ec(),d.ec(),d.ec(),d.fc(19,"div",1),d.fc(20,"mat-form-field",2),d.fc(21,"mat-label"),d.Yc(22,"Choose Service"),d.ec(),d.fc(23,"mat-select",3),d.oc("ngModelChange",(function(e){return t.selectedService=e}))("selectionChange",(function(e){return t.serviceSelectionChange(e.value)})),d.Wc(24,T,2,2,"mat-option",4),d.ec(),d.ec(),d.ec(),d.ec(),d.fc(25,"div",0),d.fc(26,"div",1),d.fc(27,"mat-form-field",2),d.fc(28,"mat-label"),d.Yc(29,"Search By"),d.ec(),d.fc(30,"mat-select",3),d.oc("ngModelChange",(function(e){return t.selectedSearchBy=e}))("selectionChange",(function(){return t.searchByChange()})),d.Wc(31,L,2,2,"mat-option",4),d.ec(),d.ec(),d.ec(),d.fc(32,"div",5),d.Wc(33,_,2,1,"mat-form-field",6),d.ec(),d.fc(34,"div",5),d.Wc(35,E,2,0,"button",7),d.Wc(36,x,2,0,"button",8),d.ec(),d.ec()),2&e&&(d.Nb(5),d.Ac("ngModel",t.selectedStatus),d.Nb(1),d.Ac("ngForOf",t.getBookingStatusText.list),d.Nb(5),d.Ac("ngModel",t.selectedMerchant),d.Nb(1),d.Ac("ngForOf",t.merchantList),d.Nb(5),d.Ac("ngModel",t.selectedBranch),d.Nb(1),d.Ac("ngForOf",t.branchList),d.Nb(5),d.Ac("ngModel",t.selectedService),d.Nb(1),d.Ac("ngForOf",t.serviceList),d.Nb(6),d.Ac("ngModel",t.selectedSearchBy),d.Nb(1),d.Ac("ngForOf",t.searchBy),d.Nb(2),d.Ac("ngIf",t.selectedSearchBy),d.Nb(2),d.Ac("ngIf",t.selectedSearchBy),d.Nb(1),d.Ac("ngIf",t.selectedSearchBy))},directives:[v.c,v.d,v.a,B.c,B.g,w.a,P.o,P.r,c.k,c.l,I.m,D.b,P.c,m.a],styles:[""]}),e})();var R=i("wd/R");let $=(()=>{class e{}return e.OPEN="OPEN",e.DISABLED="DISABLED",e.BOOKED="BOOKED",e.SELECTED="SELECTED",e})(),G=(()=>{class e{}return e.BKG_CAN="Booking Cancelled",e.BKG_CNF="Booking Confirmed",e.BKG_PROG="Booking Progress",e.BKG_CMPLT="Booking Completed",e})();var U=i("2Vo4"),W=i("md1w"),Z=i("Wp6s"),K=i("Qu3c");function q(e,t){if(1&e&&(d.fc(0,"mat-option",15),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.serviceMappingId),d.Nb(1),d.ad(" ",e.services.serviceName," ")}}function V(e,t){1&e&&(d.fc(0,"span",17),d.Yc(1," Please choose service "),d.ec())}function z(e,t){if(1&e&&(d.fc(0,"mat-error"),d.Wc(1,V,2,0,"span",16),d.ec()),2&e){const e=d.sc();d.Nb(1),d.Ac("ngIf",e.form.get("serviceMappingBean.serviceMappingId").errors.required)}}function H(e,t){if(1&e&&(d.fc(0,"mat-option",15),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.servicePersonId),d.Nb(1),d.ad(" ",e.servicePersonName," ")}}function X(e,t){1&e&&(d.fc(0,"span",17),d.Yc(1," length exceeded "),d.ec())}function j(e,t){if(1&e&&(d.fc(0,"mat-error"),d.Wc(1,X,2,0,"span",16),d.ec()),2&e){const e=d.sc();d.Nb(1),d.Ac("ngIf",e.eform.addonComments.errors.maxlength)}}function J(e,t){if(1&e){const e=d.gc();d.fc(0,"div"),d.fc(1,"mat-list-item"),d.fc(2,"a",18),d.oc("click",(function(){d.Nc(e);const i=t.index;return d.sc().removeAddOns(i)})),d.fc(3,"span",19),d.Yc(4,"remove_circle_outline"),d.ec(),d.ec(),d.Yc(5),d.ec(),d.ac(6,"mat-divider"),d.ec()}if(2&e){const e=t.$implicit;d.Nb(5),d.ad(" ",e.serviceName," ")}}let Q=(()=>{class e{constructor(e,t,i,c,o){this.dialogRef=e,this.row=t,this.formBuilder=i,this.adminBaseService=c,this.alertService=o,this.listToProcess=[],this.adonsServices=[],this.servicePersons=[]}ngOnInit(){if(this.row.data&&this.row.data.bookingStatus==s.BKG_CMPLT)return this.alertService.open(l.a.SUCCESS,"Booking already Completed."),!1;this.row.serviceList&&(this.adonsServices=this.row.serviceList),this.row.addonsServiceList&&(this.row.addonsServiceList.forEach(e=>{e.serviceMappingBean.services&&(e.serviceName=e.serviceMappingBean.services.serviceName)}),this.listToProcess=this.row.addonsServiceList.map(e=>Object.assign({},e))),this.row.data?this.form=this.formBuilder.group({bookings:this.formBuilder.group({bookingId:[this.row.data.bookingId,[P.x.required]]}),serviceMappingBean:this.formBuilder.group({serviceMappingId:[null,[P.x.required]]}),servicePersonId:[null],offerId:[null],addonComments:[null,[P.x.maxLength(1e3)]]}):this.dialogRef.close()}get eform(){return this.form.controls}onSubmit(){if(this.form.invalid)return!1;let e=this.form.value;const t=this.adonsServices.find(e=>e.serviceMappingId==this.form.get("serviceMappingBean.serviceMappingId").value);t&&(e.serviceName=t.services.serviceName),this.listToProcess.push(e),this.alertService.open(l.a.SUCCESS,"Successfully Added."),this.form.reset(),this.form.get("bookings.bookingId").setValue(this.row.data.bookingId)}onSubmitAndClose(){this.adminBaseService.requestSubmit("ADM_ADD_BOOKING_ADDONS",{listToProcess:this.listToProcess}).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.dialogRef.close({addOns:this.listToProcess}),this.alertService.open(l.a.SUCCESS,"Addons successfully Added to Booking."))},e=>{})}serviceSelectionChange(e){if(e){const t=this.adonsServices.find(t=>t.serviceMappingId==e);t&&(this.servicePersons=t.servicePerson,t.offers?this.form.get("offerId").setValue(t.offers.offerId):this.form.get("offerId").setValue(null))}}removeAddOns(e){this.listToProcess.length&&this.listToProcess.splice(e,1)}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(r.g),d.Zb(r.a),d.Zb(P.d),d.Zb(g.a),d.Zb(f.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-addons"]],decls:40,vars:7,consts:[[3,"formGroup"],["mat-dialog-title","",1,"dialog-title-h1"],[1,"m-t-5","m-b-10"],["formGroupName","serviceMappingBean",1,"full-width"],["formControlName","serviceMappingId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"full-width"],["formControlName","servicePersonId"],["color","accent",1,"full-width"],["matInput","","formControlName","addonComments"],["type","button","mat-raised-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"],[3,"value"],["class","alert-danger",4,"ngIf"],[1,"alert-danger"],["href","javascript:;","matTooltip","Remove Add One Services","matTooltipPosition","above",1,"p-r-5",3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(d.fc(0,"form",0),d.fc(1,"h1",1),d.Yc(2,"Add Ons Management"),d.ec(),d.fc(3,"mat-dialog-content"),d.fc(4,"mat-card",2),d.fc(5,"mat-card-header"),d.fc(6,"mat-card-title"),d.Yc(7,"New Add Ons"),d.ec(),d.ec(),d.fc(8,"mat-card-content"),d.fc(9,"mat-form-field",3),d.fc(10,"mat-label"),d.Yc(11,"Choose Add ons Service"),d.ec(),d.fc(12,"mat-select",4),d.oc("selectionChange",(function(e){return t.serviceSelectionChange(e.value)})),d.Wc(13,q,2,2,"mat-option",5),d.ec(),d.Wc(14,z,2,1,"mat-error",6),d.ec(),d.fc(15,"mat-form-field",7),d.fc(16,"mat-label"),d.Yc(17,"Choose Person"),d.ec(),d.fc(18,"mat-select",8),d.Wc(19,H,2,2,"mat-option",5),d.ec(),d.ec(),d.fc(20,"mat-form-field",9),d.fc(21,"mat-label"),d.Yc(22,"Comment"),d.ec(),d.ac(23,"textarea",10),d.Wc(24,j,2,1,"mat-error",6),d.ec(),d.ec(),d.fc(25,"mat-card-actions"),d.fc(26,"button",11),d.oc("click",(function(){return t.onSubmit()})),d.Yc(27,"Add & Continue"),d.ec(),d.ec(),d.ec(),d.fc(28,"mat-card"),d.fc(29,"mat-card-header"),d.fc(30,"mat-card-title"),d.Yc(31,"Add ons"),d.ec(),d.ec(),d.fc(32,"mat-card-content"),d.fc(33,"mat-list"),d.Wc(34,J,7,1,"div",12),d.ec(),d.ec(),d.ec(),d.ec(),d.fc(35,"div",13),d.fc(36,"button",11),d.oc("click",(function(){return t.onSubmitAndClose()})),d.Yc(37,"Submit"),d.ec(),d.fc(38,"button",14),d.Yc(39,"Cancel"),d.ec(),d.ec(),d.ec()),2&e&&(d.Ac("formGroup",t.form),d.Nb(13),d.Ac("ngForOf",t.adonsServices),d.Nb(1),d.Ac("ngIf",t.form.get("serviceMappingBean.serviceMappingId").invalid&&(t.form.get("serviceMappingBean.serviceMappingId").dirty||t.form.get("serviceMappingBean.serviceMappingId").touched)),d.Nb(5),d.Ac("ngForOf",t.servicePersons),d.Nb(5),d.Ac("ngIf",t.eform.addonComments.invalid&&(t.eform.addonComments.dirty||t.eform.addonComments.touched)),d.Nb(10),d.Ac("ngForOf",t.listToProcess),d.Nb(4),d.Ac("mat-dialog-close","NO"))},directives:[P.z,P.p,P.h,r.h,r.e,Z.a,Z.d,Z.h,Z.c,B.c,P.i,B.g,w.a,P.o,P.g,c.k,c.l,D.b,P.c,Z.b,m.a,b.a,r.c,r.d,I.m,B.b,b.c,K.a,S.a],styles:[""]}),e})(),ee=(()=>{class e{constructor(e){this.adminBaseService=e,this.statusMaster=null,this.statusMaster$=new U.a(this.statusMaster),this.bookedInfo=null}readStausMaster(){this.statusMaster?this.statusMaster$.next(this.statusMaster):this.adminBaseService.requestSubmit("ADM_LIST_BOOKING_STATUSMASTER",{filter:"",sortBy:"",sortOrder:"ASC"}).subscribe(e=>{e&&e.result&&(this.statusMaster=e.result.data,this.statusMaster$.next(this.statusMaster))})}}return e.\u0275fac=function(t){return new(t||e)(d.kc(g.a))},e.\u0275prov=d.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var te=i("sdPG"),ie=i("xHqg"),ce=i("znSr"),oe=i("NFeN"),se=i("A5z7"),ae=i("bSwM"),ne=i("iadO");const re=["bookingAlert"],le=["bookingConfirm"];function de(e,t){if(1&e){const e=d.gc();d.fc(0,"a",35),d.oc("click",(function(t){return d.Nc(e),d.sc().AddOneService(t)})),d.fc(1,"span",36),d.Yc(2,"playlist_add"),d.ec(),d.ec()}}function he(e,t){if(1&e&&(d.fc(0,"div"),d.fc(1,"mat-list-item"),d.Yc(2),d.ec(),d.ac(3,"mat-divider"),d.ec()),2&e){const e=t.$implicit;d.Nb(2),d.Zc(e.serviceMappingBean.services?e.serviceMappingBean.services.serviceName:e.serviceName)}}function fe(e,t){if(1&e&&(d.fc(0,"mat-option",37),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.merchantId),d.Nb(1),d.ad("",e.merchantName," ")}}function me(e,t){if(1&e&&(d.fc(0,"mat-option",37),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e.branchId),d.Nb(1),d.ad("",e.branchName," ")}}function ue(e,t){if(1&e&&(d.fc(0,"mat-option",37),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e),d.Nb(1),d.ad("",e.services.serviceName," ")}}function ge(e,t){if(1&e&&(d.fc(0,"mat-option",37),d.Yc(1),d.ec()),2&e){const e=t.$implicit;d.Ac("value",e),d.Nb(1),d.ad(" ",e.servicePersonName," ")}}function pe(e,t){if(1&e){const e=d.gc();d.fc(0,"div",4),d.fc(1,"h1",5),d.fc(2,"span",6),d.Yc(3,"Service Person"),d.ec(),d.ec(),d.fc(4,"div",7),d.fc(5,"div",38),d.fc(6,"mat-form-field",12),d.fc(7,"mat-label"),d.Yc(8,"Choose Service Person"),d.ec(),d.fc(9,"mat-select",39),d.oc("selectionChange",(function(t){return d.Nc(e),d.sc().onSelectServicePerson(t)})),d.Wc(10,ge,2,2,"mat-option",14),d.ec(),d.ec(),d.ec(),d.ec(),d.ec()}if(2&e){const e=d.sc();d.Ac("ngClass",e.row.data?"d-none":""),d.Nb(9),d.Ac("disabled",e.row.data),d.Nb(1),d.Ac("ngForOf",e.selectedService.servicePerson)}}function ve(e,t){if(1&e&&(d.fc(0,"ul"),d.fc(1,"li"),d.fc(2,"span"),d.Yc(3),d.ec(),d.fc(4,"span"),d.Yc(5),d.ec(),d.ec(),d.ec()),2&e){const e=t.$implicit;d.Nb(3),d.Zc(e.displayDay),d.Nb(2),d.Zc(e.displayMonth)}}const be=function(e,t,i){return[e,t,i]};function Se(e,t){if(1&e){const e=d.gc();d.fc(0,"mat-chip",48),d.oc("click",(function(){d.Nc(e);const i=t.$implicit;return d.sc(3).onSelectTimeSlot(i)})),d.fc(1,"span"),d.Yc(2),d.ec(),d.ec()}if(2&e){const e=t.$implicit,i=t.index,c=d.sc().$implicit,o=d.sc(2);d.Ac("selected",""===c.status)("ngClass",d.Fc(3,be,0==o.viewAllSlot&&i>7?"d-none":"",e.status,e.servicePersonAvail?"":"employee-unavail")),d.Nb(2),d.Zc(e.display)}}function Ne(e,t){if(1&e&&(d.fc(0,"div",45),d.fc(1,"mat-chip-list",46),d.Wc(2,Se,3,7,"mat-chip",47),d.ec(),d.ec()),2&e){const e=t.$implicit;d.Nb(1),d.Ac("selectable",!0),d.Nb(1),d.Ac("ngForOf",e.hourSlot)}}function Ce(e,t){if(1&e){const e=d.gc();d.fc(0,"div",49),d.fc(1,"a",50),d.oc("click",(function(){return d.Nc(e),d.sc(2).slotViewOption()})),d.Yc(2),d.ec(),d.ec()}if(2&e){const e=d.sc(2);d.Nb(2),d.ad(" ",e.viewAllSlot?"View less":"View All"," ")}}function ke(e,t){if(1&e&&(d.fc(0,"div"),d.fc(1,"h1",5),d.fc(2,"span",6),d.Yc(3,"Choose Date"),d.ec(),d.ec(),d.fc(4,"nav"),d.fc(5,"button",40),d.fc(6,"mat-icon"),d.Yc(7,"keyboard_arrow_left"),d.ec(),d.ec(),d.Wc(8,ve,6,2,"ul",10),d.fc(9,"button",41),d.fc(10,"mat-icon"),d.Yc(11,"keyboard_arrow_right"),d.ec(),d.ec(),d.ec(),d.fc(12,"div",42),d.Wc(13,Ne,3,2,"div",43),d.ec(),d.Wc(14,Ce,3,1,"div",44),d.ec()),2&e){const e=d.sc();d.Nb(8),d.Ac("ngForOf",e.slotList),d.Nb(5),d.Ac("ngForOf",e.slotList),d.Nb(1),d.Ac("ngIf",e.slotList.length>0)}}function Me(e,t){1&e&&(d.fc(0,"span",52),d.Yc(1," Name is required "),d.ec())}function Ae(e,t){1&e&&(d.fc(0,"span",52),d.Yc(1," length exceeded "),d.ec())}function Be(e,t){if(1&e&&(d.fc(0,"mat-error"),d.Wc(1,Me,2,0,"span",51),d.Wc(2,Ae,2,0,"span",51),d.ec()),2&e){const e=d.sc();d.Nb(1),d.Ac("ngIf",e.cnfrmform.guestUserName.errors.required),d.Nb(1),d.Ac("ngIf",e.cnfrmform.guestUserName.errors.maxlength)}}function we(e,t){1&e&&(d.fc(0,"span",52),d.Yc(1," Mobile Number is required "),d.ec())}function Pe(e,t){1&e&&(d.fc(0,"span",52),d.Yc(1," Please enter a valid Mobile Number "),d.ec())}function Ie(e,t){if(1&e&&(d.fc(0,"mat-error"),d.Wc(1,we,2,0,"span",51),d.Wc(2,Pe,2,0,"span",51),d.ec()),2&e){const e=d.sc();d.Nb(1),d.Ac("ngIf",e.cnfrmform.guestUserMobile.errors.required),d.Nb(1),d.Ac("ngIf",e.cnfrmform.guestUserMobile.errors.pattern)}}function De(e,t){if(1&e&&(d.fc(0,"span"),d.Yc(1),d.ec()),2&e){const e=d.sc(3);d.Nb(1),d.ad("Booking End Date - ",e.row.data.bookingEndDate,"")}}function Ye(e,t){if(1&e){const e=d.gc();d.fc(0,"mat-form-field",59),d.fc(1,"mat-label"),d.Yc(2,"Choose End date"),d.ec(),d.fc(3,"input",60),d.oc("click",(function(){return d.Nc(e),d.Jc(5).open()}))("dateChange",(function(t){return d.Nc(e),d.sc(3).repeatBookingDateChange(t)})),d.ec(),d.ac(4,"mat-datepicker",null,61),d.ec()}if(2&e){const e=d.Jc(5),t=d.sc(3);d.Nb(3),d.Ac("matDatepicker",e)("disabled",!!t.row.data)("min",t.repeatBookMinDate)("max",t.repeatBookMaxDate)}}function ye(e,t){if(1&e&&(d.fc(0,"div",54),d.Wc(1,De,2,1,"span",18),d.Wc(2,Ye,6,4,"mat-form-field",57),d.fc(3,"span",58),d.Yc(4),d.ec(),d.ec()),2&e){const e=d.sc(2);d.Nb(1),d.Ac("ngIf",e.row.data),d.Nb(1),d.Ac("ngIf",!e.row.data),d.Nb(2),d.ad(" ",e.repeatBookingDateAlert," ")}}const Oe=function(){return{standalone:!0}};function Te(e,t){if(1&e){const e=d.gc();d.fc(0,"div",53),d.fc(1,"div",54),d.fc(2,"mat-checkbox",55),d.oc("ngModelChange",(function(t){return d.Nc(e),d.sc().repeatBooking=t})),d.Yc(3," Repeated Booking"),d.ec(),d.ec(),d.Wc(4,ye,5,3,"div",56),d.ec()}if(2&e){const e=d.sc();d.Nb(2),d.Ac("disabled",!!e.row.data)("checked",e.repeatBooking)("ngModel",e.repeatBooking)("ngModelOptions",d.Cc(5,Oe)),d.Nb(2),d.Ac("ngIf",e.repeatBooking)}}var Le,_e,Ee,xe;function Fe(e,t){if(1&e&&(d.fc(0,"span"),d.Yc(1),d.ec()),2&e){const e=d.sc(3);d.Nb(1),d.Zc(e.alertOnSlots.slot.time)}}function Re(e,t){1&e&&(d.fc(0,"span"),d.jc(1,Ee),d.ec())}function $e(e,t){if(1&e&&(d.fc(0,"p"),d.Yc(1),d.fc(2,"span"),d.jc(3,Le),d.ec(),d.Yc(4,"\xa0"),d.Wc(5,Fe,2,1,"span",18),d.Wc(6,Re,2,0,"span",18),d.Yc(7,".\xa0"),d.fc(8,"span"),d.jc(9,_e),d.ec(),d.ec()),2&e){const e=d.sc(2);d.Nb(1),d.ad(" ",e.selectedServicePerson.servicePersonName,"\xa0"),d.Nb(4),d.Ac("ngIf",e.alertOnSlots.slot),d.Nb(1),d.Ac("ngIf",!e.alertOnSlots.slot)}}function Ge(e,t){1&e&&(d.fc(0,"p"),d.Yc(1," Service person is not available on your selected time slot, kindly requesting you to change the time slot or choose another available service person "),d.ec())}function Ue(e,t){1&e&&(d.fc(0,"p"),d.jc(1,xe),d.ec())}function We(e,t){if(1&e&&(d.fc(0,"span"),d.Yc(1),d.ec()),2&e){const e=d.sc(3);d.Nb(1),d.Zc(e.alertOnSlots.slot.date)}}function Ze(e,t){if(1&e&&(d.fc(0,"span"),d.Yc(1),d.ec()),2&e){const e=d.sc(3);d.Nb(1),d.Zc(e.alertOnSlots.slot.time)}}function Ke(e,t){if(1&e&&(d.fc(0,"p"),d.Yc(1," You are about to change the booked time slot. Selected time slot on \xa0 "),d.Wc(2,We,2,1,"span",18),d.Yc(3,"\xa0 at "),d.Wc(4,Ze,2,1,"span",18),d.Yc(5,"."),d.ac(6,"br"),d.Yc(7," Do want to continue? "),d.ec()),2&e){const e=d.sc(2);d.Nb(2),d.Ac("ngIf",e.alertOnSlots.slot),d.Nb(2),d.Ac("ngIf",e.alertOnSlots.slot)}}function qe(e,t){if(1&e){const e=d.gc();d.fc(0,"button",66),d.oc("click",(function(){return d.Nc(e),d.sc(2).closeBookingAlert("ok")})),d.Yc(1,"Ok"),d.ec()}}function Ve(e,t){if(1&e){const e=d.gc();d.fc(0,"button",66),d.oc("click",(function(){return d.Nc(e),d.sc(2).closeBookingAlert("yes")})),d.Yc(1,"Yes"),d.ec()}}function ze(e,t){if(1&e){const e=d.gc();d.fc(0,"button",66),d.oc("click",(function(){return d.Nc(e),d.sc(2).closeBookingAlert("no")})),d.Yc(1,"No"),d.ec()}}function He(e,t){if(1&e&&(d.fc(0,"h1",62),d.Yc(1),d.ec(),d.fc(2,"mat-dialog-content"),d.fc(3,"div",63),d.Wc(4,$e,10,3,"p",18),d.Wc(5,Ge,2,0,"p",18),d.Wc(6,Ue,2,0,"p",18),d.Wc(7,Ke,8,2,"p",18),d.ec(),d.ec(),d.fc(8,"div",64),d.Wc(9,qe,2,0,"button",65),d.Wc(10,Ve,2,0,"button",65),d.Wc(11,ze,2,0,"button",65),d.ec()),2&e){const e=d.sc();d.Nb(1),d.Zc(e.alertOnSlots.title),d.Nb(3),d.Ac("ngIf","unavailserviceperson"===e.alertOnSlots.type&&e.selectedServicePersonId),d.Nb(1),d.Ac("ngIf","unavailserviceperson"===e.alertOnSlots.type&&!e.selectedServicePersonId),d.Nb(1),d.Ac("ngIf","unmappedserviceperson"===e.alertOnSlots.type),d.Nb(1),d.Ac("ngIf","bookingConfirm"===e.alertOnSlots.type),d.Nb(2),d.Ac("ngIf","unavailserviceperson"===e.alertOnSlots.type),d.Nb(1),d.Ac("ngIf","bookingConfirm"===e.alertOnSlots.type),d.Nb(1),d.Ac("ngIf","bookingConfirm"===e.alertOnSlots.type)}}function Xe(e,t){if(1&e){const e=d.gc();d.fc(0,"h1",62),d.Yc(1,"Booked successfully"),d.ec(),d.fc(2,"div",67),d.Yc(3),d.ec(),d.fc(4,"div",64),d.fc(5,"button",68),d.oc("click",(function(){return d.Nc(e),d.sc().CloseAllModal()})),d.Yc(6,"Close"),d.ec(),d.ec()}if(2&e){const e=d.sc();d.Nb(3),d.Zc(e.repeatBookingDateAlert)}}Le=$localize`:@@isNotAvailableAt␟8d9395fdb0ae116c626555e1ff43337f967fad51␟2532495749531663222:is not available at`,_e=$localize`:@@pleaseChooseDiffTime␟869c05a086d540c11d64dcb71673a1cd8715fae4␟1491623464337929787:Please choose a different time or person`,Ee=$localize`:@@seletedTime␟da61dab6e82a5ceffff8ec1adcd5fde277afae75␟7931136143311304460:selected time`,xe=$localize`:@@unmappedserviceperson␟1569e53dcf2912c7871b649eb16575ee7e4b4b81␟691364837678178735: No service persons are available for taking this appointment,you can directly call to branch for taking an appointment `;let je=(()=>{class e{constructor(e,t,i,c,o,s,a,n,r,l,d,h,f,m){this.dialog=e,this.dialogRef=t,this.row=i,this.formBuilder=c,this.manageGridService=o,this.headerService=s,this.adminBaseService=a,this.datepipe=n,this.alertService=r,this.bookingService=l,this.authenticationService=d,this.initializeService=h,this.dropDownService=f,this.dialogRefAll=m,this.merchantList=[],this.branchList=[],this.serviceList=[],this.bookingStatusBean=[],this.step=0,this.slotList=[],this.totalDay=7,this.viewAllSlot=!1,this.serviceTime=30,this.servicePersonLevelBooking=!1,this.servicePersonList=[],this.subscriptions=[],this.isLoaded$=new U.a(!1),this.addonsServiceList=[],this.page=1,this.slotBookingPer=0,this.amountSplitUps={serviceAmount:0,discount:0,total:0,savedAmount:0},this.repeatBookMinDate=new Date,this.repeatBuffer=new Date((new Date).setMonth((new Date).getMonth()+1)),this.repeatBookMaxDate=this.repeatBuffer,this.repeatBooking=!1,this.repeatBookingDate=null,this.repeatBookingDateAlert=null}get cnfrmform(){return this.confirmFormGroup.controls}ngOnInit(){if(this.row.data&&this.row.data.bookingStatus==s.BKG_CMPLT)return this.alertService.open(l.a.ERROR,"Booking already Completed."),this.dialogRef.close(),!1;this.headerService.toggleSpinner(!0),this.subscriptions.push(this.initializeService.initializeCompleted$.subscribe(e=>{e&&this.authenticationService.userInfo&&(this.userInfo=this.authenticationService.userInfo,this.isLoaded$.next(!0))})),this.subscriptions.push(this.isLoaded$.subscribe(e=>{e&&(this.secondFormGroup=this.formBuilder.group({merchantId:["",[P.x.required]],branchId:["",[P.x.required]],serviceId:["",[P.x.required]],selectedSlot:["",[P.x.required]],servicePersonId:[""]}),this.confirmFormGroup=this.formBuilder.group({guestUserMobile:[this.row.data?this.row.data.guestUserMobile:"",[P.x.required,P.x.pattern("^(\\+\\d{1,3}[- ]?)?\\d{7,15}$")]],guestUserName:[this.row.data?this.row.data.guestUserName:"",[P.x.required,P.x.maxLength(100)]]}),this.headerService.toggleSpinner(!0),this.row.data&&(this.row.data.branchServicePerson&&(this.selectedServicePersonId=this.row.data.branchServicePerson.servicePersonId),"true"==this.row.data.repeatedBooking&&(this.repeatBooking=!0),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_BOOKING_ADDONS",{filter:"bookings.bookingId=="+this.row.data.bookingId,sortBy:"",sortOrder:"ASC"}).subscribe(e=>{e.result&&e.result.status===l.a.SUCCESS&&(this.addonsServiceList=e.result.data)}))),this.subscriptions.push(this.dropDownService.getMerchant("ADM_LIST_MERCHANTS",null).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.merchantList=e.result.data,1===this.merchantList.length&&(this.selectedMerchant=this.merchantList[0].merchantId,this.merchantSelectionChange(this.selectedMerchant)),this.row&&this.row.data&&(this.merchantSelectionChange(this.row.data.serviceMappingBean.branch.merchantBean.merchantId),this.selectedMerchant=this.row.data.serviceMappingBean.branch.merchantBean.merchantId,this.selectedServicePerson=this.row.data.branchServicePerson?this.row.data.branchServicePerson:null,this.secondFormGroup.get("servicePersonId").setValue(this.row.data.branchServicePerson?this.row.data.branchServicePerson.servicePersonId:null))),this.bookingService.readStausMaster(),this.subscriptions.push(this.bookingService.statusMaster$.subscribe(e=>{e&&(this.bookingStatusBean=e,this.headerService.toggleSpinner(!1))})))},e=>{this.headerService.toggleSpinner(!1)})))}))}get moduleKeyModel(){return a.a}merchantSelectionChange(e){if(this.branchList=[],this.serviceList=[],e){const t={filter:"merchantBean.merchantId=="+e};this.headerService.toggleSpinner(!0),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_MERCHANT_BRANCHES",t).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.branchList=e.result.data,this.row&&this.row.data&&(this.branchSelectionChange(this.row.data.serviceMappingBean.branch.branchId),this.selectedBranch=this.row.data.serviceMappingBean.branch.branchId)),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}}branchSelectionChange(e){if(this.serviceList=[],e&&(this.branchInfo=this.branchList.find(t=>t.branchId===e),this.branchInfo)){this.operationHours=this.branchInfo.branchOperationTime;const e={filter:"branch.branchId=="+this.branchInfo.branchId};this.headerService.toggleSpinner(!0),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_SERVICE_MAPPING",e).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.serviceList=e.result.data,this.row&&this.row.data&&(this.serviceSelectionChange(this.row.data.serviceMappingBean,"edit"),this.selectedService=this.row.data.serviceMappingBean)),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}}serviceSelectionChange(e,t="new"){if(e)if(e){if(this.selectedSlot=null,this.selectedService=e,this.servicePersonLevelBooking=Boolean(JSON.parse(e.servicePersonLevelBooking)),e.servicePersonList&&(this.servicePersonList=e.servicePerson),this.serviceTime=+e.servicePersonAvgDuration,!1===this.createSlot())return!1;this.slotList=this.slotList.filter(t=>t.hourSlot.map(t=>{t.numberOfBookingAllowed=e.numberOfBookingAllowed,t.servicePersonList=e.servicePerson,t.servicePersonAvail=!0})),this.manageSlot(e.serviceMappingId,t)}else this.selectedService=null,this.selectedSlot=null}manageSlot(e,t){let i=null;this.page>1?(i=new Date,i.setDate(i.getDate()+this.totalDay)):i=new Date;const c={filter:`serviceMappingBean.serviceMappingId==${e}##bookingStatus==${G.BKG_CNF}##bookingDate::${this.datepipe.transform(new Date,"dd-MM-yyyy")},${this.datepipe.transform(i.setDate(i.getDate()+1),"dd-MM-yyyy")},${this.datepipe.transform(i.setDate(i.getDate()+1),"dd-MM-yyyy")}`,sortBy:"",sortOrder:"ASC"};setTimeout(()=>{this.headerService.toggleSpinner(!0)},100),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_BOOKINGS",c).subscribe(e=>{if(e&&e.result&&e.result.status===l.a.SUCCESS&&e.result.data&&this.slotList.length>0&&(e.result.data.forEach((e,t)=>{const i=this.slotList.filter(t=>t.hourSlot.some(t=>t.date===e.bookingDate&&t.time===e.bookingStartTime&&t.status!==$.DISABLED)).map(t=>t.hourSlot.find(t=>t.date===e.bookingDate&&t.time===e.bookingStartTime));if(i.length>0){if(i[0].numberOfBookingAllowed-=1,i[0].servicePersonList){const t=i[0].servicePersonList.find(t=>t.servicePersonId===e.branchServicePerson.servicePersonId);if(t){const e=[...i[0].servicePersonList];e.length>0&&(e.splice(e.indexOf(t),1),i[0].servicePersonList=e)}}0===i[0].numberOfBookingAllowed&&(i[0].status=$.BOOKED)}}),"edit"===t&&this.row.data)){const e=this.slotList.filter(e=>e.hourSlot.some(e=>e.date===this.row.data.bookingDate&&e.time===this.row.data.bookingStartTime&&e.status!==$.DISABLED)).map(e=>e.hourSlot.find(e=>e.date===this.row.data.bookingDate&&e.time===this.row.data.bookingStartTime));e&&e.length>0&&(e[0].status=$.DISABLED,this.selectedSlot=e[0]),this.row.data.branchServicePerson&&this.onSelectServicePerson(this.row.data.branchServicePerson)}setTimeout(()=>{this.headerService.toggleSpinner(!1)},100)},e=>{}))}getDayOfWeek(e,t,i){let c=$.OPEN;if(e<new Date)c=$.DISABLED;else{if(this.branchInfo.branchHolidays){const t=R(new Date(e)).format("DD-MM-YYYY");if(null!=this.branchInfo.branchHolidays.split(",").find(e=>e==t))return c=$.DISABLED,c}if(i){const t=new Date(e).getDay(),o=isNaN(t)?null:W.a.days[t],s=i.find(e=>e.day.value==o.value);if(s&&s.start&&s.end){const t=R(`${R(e).format("DD-MM-YYYY")} ${s.start}`,"DD-MM-YYYY hh:mm A").toDate(),i=R(`${R(e).format("DD-MM-YYYY")} ${s.end}`,"DD-MM-YYYY hh:mm A").toDate();if(!(e>=t||e<i))return c=$.DISABLED,c}}const o=new Date(e).getDay(),s=isNaN(o)?null:W.a.days[o];s&&this.selectedService&&t.find(e=>e.value.toUpperCase()===s.value.toUpperCase())&&(c=$.DISABLED)}return c}createSlot(){if(this.selectedService){if(isNaN(this.serviceTime))return this.alertService.open(l.a.ERROR,"Please check service duration."),this.slotList=[],!1;const e=[];let t;this.selectedService.branch.branchHolidays&&(this.selectedService.branch.branchHolidays.indexOf("-")>-1?this.selectedService.branch.branchWeeklyOff.split("-").forEach(t=>{let i=W.a.days.findIndex(e=>e.value===t);i>-1&&e.push(W.a.days[i])}):e.push(W.a.days.find(e=>e.value===this.selectedService.branch.branchWeeklyOff))),this.branchInfo.branchbreakTime&&(t=JSON.parse(this.selectedService.branch.branchbreakTime)),this.slotList=[];const i=[this.selectedService.servicePersonStartTime,this.selectedService.servicePersonEndTime];let c,o,s;for(let a=1;a<=this.totalDay;a++){1===a?s=new Date:s.setDate(s.getDate()+1);const n={displayDay:""+R(s).format("ddd"),displayMonth:`${R(s).format("DD")} ${R(s).format("MMM")}`,value:R(s).format("DD-MM-YYYY"),hourSlot:[]};let r=!0;if(i.forEach((e,t)=>{const i=e.split(" ");if(0===t){if(c=new Date(`${R(s).format("YYYY-MM-DD")} ${i[0]}:00 ${i[1]}`),isNaN(c.getTime()))return this.alertService.open(l.a.ERROR,"Please check your service start time."),r=!1,!1}else if(1===t&&(o=new Date(`${R(s).format("YYYY-MM-DD")} ${i[0]}:00 ${i[1]}`),isNaN(o.getTime())))return this.alertService.open(l.a.ERROR,"Please check your service end time."),r=!1,!1}),!r)return this.slotList=[],!1;do{const i=this.getDayOfWeek(c,e,t);n.hourSlot.push({display:i===$.OPEN?R(c).format("hh:mm a"):" - ",time:R(c).format("hh:mm a"),date:R(s).format("DD-MM-YYYY"),value:R(c).format("YYYY-MM-DD hh:mm ss a"),status:i}),c.setMinutes(c.getMinutes()+this.serviceTime)}while(c<o);this.slotList.push(n)}}}onSelectTimeSlot(e){if(e&&(e.status===$.OPEN.toString()||e.status===$.SELECTED)&&this.authenticationService.isLoggedIn())if(e.servicePersonAvail)if(e.servicePersonList.length>0){let t=null;if(this.selectedServicePersonId&&this.selectedServicePerson){let i=[];if(this.selectedServicePerson.servicePersonWorkingTime){i=JSON.parse(this.selectedServicePerson.servicePersonWorkingTime);const c=this.selectedServicePerson.servicePersonHolidays?this.selectedServicePerson.servicePersonHolidays.split(","):[];if(!this.checkSlotAvailForServicePerson(e,i,c))return this.alertOnSlots={title:"Service person not available!",type:"unavailserviceperson",slot:e},this.openBookingAlertModal(),!1;t=this.selectedServicePerson}}else{let i=e.servicePersonList.length;if(this.headerService.toggleSpinner(!0),e.servicePersonList.forEach((c,o)=>{let s=[];c.servicePersonWorkingTime&&(s=JSON.parse(c.servicePersonWorkingTime));const a=c.servicePersonHolidays?c.servicePersonHolidays.split(","):[];if(this.checkSlotAvailForServicePerson(e,s,a)){if(!t)return void(t=c)}else i-=1}),this.headerService.toggleSpinner(!1),0==i)return this.alertOnSlots={title:"Service person not available!",type:"unavailserviceperson",slot:e},this.openBookingAlertModal(),!1}if(t){const i=R(e.value,"YYYY-MM-DD hh:mm ss a");if(R(i).isAfter(R(new Date,"YYYY-MM-DD hh:mm ss a"))){this.step=2,this.secondFormGroup.get("selectedSlot").setValue(e.value),this.selectedSlot=e,this.slotList=this.slotList.filter(e=>e.hourSlot.map(e=>{e.status=e.status===$.SELECTED?$.OPEN:e.status})),this.selectedSlot.status=$.SELECTED;const t=R(this.selectedSlot.value,"YYYY-MM-DD hh:mm ss a");this.repeatBookMinDate=t.toDate(),this.repeatBuffer=new Date(t.toDate().setMonth(t.toDate().getMonth()+1)),this.repeatBookMaxDate=this.repeatBuffer,this.repeatBookingDate=null,this.repeatBookingDateAlert=null,this.row.data||(this.repeatBooking=!1)}this.selectedServicePerson=t,this.row.data&&(this.alertOnSlots={title:"Do you want to change the slot?",type:"bookingConfirm",slot:e},this.openBookingAlertModal())}else this.alertOnSlots={title:"Service person not available!",type:"unavailserviceperson",slot:e},this.openBookingAlertModal()}else this.alertOnSlots={title:"Service person not available!",type:"unmappedserviceperson",slot:e},this.openBookingAlertModal();else this.alertOnSlots={title:"Service person not available!",type:"unavailserviceperson",slot:e},this.openBookingAlertModal()}openBookingAlertModal(){this.actionDialogBookAlert=this.dialog.open(this.bookingAlertTemplate,{disableClose:!1})}closeBookingAlert(e){"ok"==e?(this.selectedSlot=null,this.actionDialogBookAlert&&this.actionDialogBookAlert.close()):"yes"==e?(this.actionDialogBookAlert&&this.actionDialogBookAlert.close(),this.bookNow()):"no"==e&&(this.selectedSlot=null,this.actionDialogBookAlert&&this.actionDialogBookAlert.close())}bookNow(){if(!this.confirmFormGroup.valid)return!1;if(this.bookingStatusBean.find(e=>e.statusCode===G.BKG_CNF),this.selectedService&&this.branchInfo&&this.selectedSlot&&this.selectedServicePerson){const e=R(this.selectedSlot.value,"YYYY-MM-DD hh:mm ss a");if(null==this.row.data){this.headerService.toggleSpinner(!0);const t=this.createBookNowRequestBody(e);this.repeatBooking&&this.repeatBookingDate?(t.repeatedBooking=!0,t.bookingEndDate=this.repeatBookingDate):(t.repeatedBooking=!1,t.bookingEndDate=null),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_ADD_BOOKING",t).subscribe(e=>{e&&e.result&&e.result.status===l.a.SUCCESS&&(this.repeatBooking=!1,this.repeatBookingDate=null,e.result.data.warningMessage?(this.repeatBookingDateAlert="Please Note, Slots are not available on "+e.result.data.warningMessage,this.actionDialogBookAlert=this.dialog.open(this.bookingConfirmTemplate,{disableClose:!1})):(this.alertService.open(l.a.SUCCESS,"Booked successfully."),this.dialogRef.close({action:"Reload"}))),setTimeout(()=>{this.headerService.toggleSpinner(!1)},100),this.headerService.toggleSpinner(!1)}))}else this.row.data&&(this.row.data.bookingDate=e.format("DD-MM-YYYY"),this.row.data.bookingStartTime=e.format("hh:mm a"),this.row.data.bookingEndTime=e.add(this.serviceTime,"minutes").format("hh:mm a"),setTimeout(()=>{this.headerService.toggleSpinner(!0)},100),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_UPDATE_BOOKING",this.row.data).subscribe(e=>{e&&e.result&&e.result.status===l.a.SUCCESS&&(this.alertService.open(l.a.SUCCESS,"Booking updated successfully."),this.dialogRef.close({action:"Reload"})),setTimeout(()=>{this.headerService.toggleSpinner(!1)},100)})))}}onSelectServicePerson(e){const t=e.value;if(t){this.selectedServicePersonId=t.servicePersonId;let e=[];t.servicePersonWorkingTime&&(e=JSON.parse(t.servicePersonWorkingTime));const i=t.servicePersonHolidays?t.servicePersonHolidays.split(","):[];this.step=3,this.selectedServicePerson=t,this.slotList.forEach(t=>{t.hourSlot.forEach(t=>{t.servicePersonAvail=!0,t.servicePersonList.find(e=>e.servicePersonId==this.selectedServicePersonId)&&e.length?this.checkSlotAvailForServicePerson(t,e,i):t.servicePersonAvail=!1})})}}AddOneService(e){this.row.data&&this.dialog.open(Q,{disableClose:!0,width:"600px",data:{data:this.row.data,serviceList:this.serviceList,addonsServiceList:this.addonsServiceList}}).afterClosed().subscribe(e=>{e&&e.addOns&&(this.addonsServiceList=e.addOns)})}checkSlotAvailForServicePerson(e,t,i){if((e.status===$.OPEN||e.status===$.SELECTED)&&t){if(i.find(t=>t==e.date))return e.servicePersonAvail=!1,!1;const c=R(e.value,"YYYY-MM-DD hh:mm ss a"),o=c.toDate().getDay(),s=isNaN(o)?null:W.a.days[o+1];let a=null;if(!(s&&t.length>0))return e.servicePersonAvail=!1,!1;if(a=t.find(e=>1==e.available&&e.day.value.toUpperCase()===s.value.toUpperCase()),!a)return e.servicePersonAvail=!1,!1;if(e.servicePersonAvail=!0,e.servicePersonAvail&&a){const t=R(e.date+" "+a.start,"DD-MM-YYYY hh:mm A"),i=R(e.date+" "+a.end,"DD-MM-YYYY hh:mm A");if(!R(c).isSameOrAfter(t)||R(c).isAfter(i))return e.servicePersonAvail=!1,!1;e.servicePersonAvail=!0}if(a&&e.servicePersonAvail&&a.breakstart&&a.breakend){const t=R(e.date+" "+a.breakstart,"DD-MM-YYYY hh:mm A"),i=R(e.date+" "+a.breakend,"DD-MM-YYYY hh:mm A");if(R(c).isSameOrAfter(t)&&R(i).isAfter(c))return e.servicePersonAvail=!1,!1}return!0}}slotViewOption(){this.viewAllSlot=!this.viewAllSlot}createBookNowRequestBody(e){var t,i,c,o,s;return{actualPrice:""+this.selectedService.servicePrice,bookingComments:null,bookingDate:e.format("DD-MM-YYYY"),bookingStartTime:e.format("hh:mm a"),bookingEndTime:e.add(this.serviceTime,"minutes").format("hh:mm a"),bookingStatus:G.BKG_CNF,branchId:this.branchInfo.branchId,branchName:this.branchInfo.branchName,branchNameAR:this.branchInfo.branchNameAR,categoryId:this.selectedService.services.category.categoryId,categoryName:this.selectedService.services.category.categoryName,categoryNameAR:this.selectedService.services.category.categoryNameAR,isLiked:!1,liked:!1,merchantId:this.branchInfo.merchantBean.merchantId,merchantName:this.branchInfo.merchantBean.merchantName,merchantNameAR:this.branchInfo.merchantBean.merchantNameAR,offerAmount:this.selectedService.offerAmount,offerAppliedPrice:null,offerId:null===(t=this.selectedService.offers)||void 0===t?void 0:t.offerId,offerName:null===(i=this.selectedService.offers)||void 0===i?void 0:i.offerName,offerNameAR:null===(c=this.selectedService.offers)||void 0===c?void 0:c.offerNameAR,offerType:null===(o=this.selectedService.offers)||void 0===o?void 0:o.offerType.offerTypeName,offerValue:null===(s=this.selectedService.offers)||void 0===s?void 0:s.offerValue,serviceId:this.selectedService.services.serviceId,serviceMappingId:this.selectedService.serviceMappingId,serviceName:this.selectedService.services.serviceName,serviceNameAR:this.selectedService.services.serviceNameAR,servicePersonId:this.selectedServicePerson.servicePersonId,servicePersonName:this.selectedServicePerson.servicePersonName,adminUserId:this.authenticationService.readLoggedUserId(),guestUserName:this.confirmFormGroup.get("guestUserName").value,guestUserMobile:this.confirmFormGroup.get("guestUserMobile").value}}repeatBookingDateChange(e){if(e.value&&this.selectedService&&this.selectedSlot&&this.selectedServicePerson){this.repeatBookingDateAlert=null,this.repeatBookingDate=R(e.value).format("DD-MM-YYYY");const t=R(this.selectedSlot.value,"YYYY-MM-DD hh:mm ss a");this.headerService.toggleSpinner(!0);const i=this.createBookNowRequestBody(t);i.repeatedBooking=!0,i.bookingEndDate=this.repeatBookingDate,this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_CHECK_REPEATED_AVAILAIBILITY",i).subscribe(e=>{e&&e.result&&(this.repeatBookingDateAlert=e.result.status===l.a.SUCCESS&&e.result.data?"Slots are not available on "+e.result.data:null),this.headerService.toggleSpinner(!1)},e=>{this.repeatBookingDateAlert=null,this.headerService.toggleSpinner(!1)}))}}CloseAllModal(){this.dialogRefAll.closeAll()}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(r.b),d.Zb(r.g),d.Zb(r.a),d.Zb(P.d),d.Zb(h.a),d.Zb(C.a),d.Zb(g.a),d.Zb(c.e),d.Zb(f.a),d.Zb(ee),d.Zb(M.a),d.Zb(te.a),d.Zb(k.a),d.Zb(r.b))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-grid-action"]],viewQuery:function(e,t){var i;1&e&&(d.Sc(re,!0),d.Sc(le,!0)),2&e&&(d.Ic(i=d.pc())&&(t.bookingAlertTemplate=i.first),d.Ic(i=d.pc())&&(t.bookingConfirmTemplate=i.first))},decls:106,vars:32,consts:[[3,"linear"],["stepper",""],["label","Fill the Form",3,"stepControl"],[3,"formGroup"],[3,"ngClass"],[1,"h3","title"],[1,"ib-m"],[1,"search-content"],[1,"w-300px"],["href","javascript:;","matTooltip","Add One Services","matTooltipPosition","above",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"w-100"],["appearance","fill",1,"full-width-80"],["formControlName","merchantId",3,"disabled","value","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","branchId",3,"disabled","ngModel","ngModelChange","selectionChange"],["formControlName","serviceId",3,"disabled","ngModel","ngModelChange","selectionChange"],[3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"m-t-15"],["mat-raised-button","","matStepperNext","","color","primary",1,"m-l-10"],["mat-raised-button","","color","warn",1,"m-l-10",3,"mat-dialog-close"],["label","Confirm"],["ngForm","ngForm"],["fxLayout","row","fxFill",""],["fxFlex","50"],["color","accent",1,"full-width"],["matInput","","placeholder","Name","autocomplete","off","formControlName","guestUserName","required","",3,"readonly"],["matInput","","placeholder","Mobile Number","autocomplete","off","formControlName","guestUserMobile","required","",3,"readonly"],["fxFlex","50","class","m-l-10 m-t-15",4,"ngIf"],[1,"confirmarion-R"],["mat-raised-button","","color","primary","matStepperPrevious",""],["mat-raised-button","","type","submit","color","primary",1,"m-l-10",3,"click"],["bookingAlert",""],["bookingConfirm",""],["href","javascript:;","matTooltip","Add One Services","matTooltipPosition","above",3,"click"],[1,"material-icons"],[3,"value"],[1,"w-40"],["formControlName","servicePersonId",3,"disabled","selectionChange"],["mat-icon-button","","color","primary","aria-label","Previous"],["mat-icon-button","","color","primary","aria-label","Next"],[1,"slots"],["class","col",4,"ngFor","ngForOf"],["class","view-all",4,"ngIf"],[1,"col"],["aria-label","Book a Session",1,"mat-chip-list-stacked",3,"selectable"],["multiple","",3,"selected","ngClass","click",4,"ngFor","ngForOf"],["multiple","",3,"selected","ngClass","click"],[1,"view-all"],[3,"click"],["class","alert-danger",4,"ngIf"],[1,"alert-danger"],["fxFlex","50",1,"m-l-10","m-t-15"],[1,"full-width"],[1,"example-margin",3,"disabled","checked","ngModel","ngModelOptions","ngModelChange"],["class","full-width",4,"ngIf"],["class","example-full-width full-width","appearance","fill",4,"ngIf"],[1,"mat-error"],["appearance","fill",1,"example-full-width","full-width"],["matInput","","readonly","",3,"matDatepicker","disabled","min","max","click","dateChange"],["picker",""],["mat-dialog-title",""],[1,"booking-content","modal-alert-content"],["mat-dialog-actions",""],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"click",4,"ngIf"],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"click"],["mat-dialog-content",""],["mat-button","",3,"click"]],template:function(e,t){if(1&e&&(d.fc(0,"mat-dialog-content"),d.fc(1,"mat-horizontal-stepper",0,1),d.fc(3,"mat-step",2),d.fc(4,"form",3),d.fc(5,"div",4),d.fc(6,"h1",5),d.fc(7,"span",6),d.Yc(8,"Add Ons Services"),d.ec(),d.ec(),d.fc(9,"div",7),d.fc(10,"mat-list",8),d.fc(11,"mat-list-item"),d.Wc(12,de,3,0,"a",9),d.ec(),d.ac(13,"mat-divider"),d.Wc(14,he,4,1,"div",10),d.ec(),d.ec(),d.ec(),d.fc(15,"div",4),d.fc(16,"h1",5),d.fc(17,"span",6),d.Yc(18,"Choose Service"),d.ec(),d.ec(),d.fc(19,"div",7),d.fc(20,"div",11),d.fc(21,"mat-form-field",12),d.fc(22,"mat-label"),d.Yc(23,"Choose Merchant"),d.ec(),d.fc(24,"mat-select",13),d.oc("ngModelChange",(function(e){return t.selectedMerchant=e}))("selectionChange",(function(e){return t.merchantSelectionChange(e.value)})),d.Wc(25,fe,2,2,"mat-option",14),d.ec(),d.ec(),d.ec(),d.fc(26,"div",11),d.fc(27,"mat-form-field",12),d.fc(28,"mat-label"),d.Yc(29,"Choose Branch"),d.ec(),d.fc(30,"mat-select",15),d.oc("ngModelChange",(function(e){return t.selectedBranch=e}))("selectionChange",(function(e){return t.branchSelectionChange(e.value)})),d.Wc(31,me,2,2,"mat-option",14),d.ec(),d.ec(),d.ec(),d.fc(32,"div",11),d.fc(33,"mat-form-field",12),d.fc(34,"mat-label"),d.Yc(35,"Choose Service"),d.ec(),d.fc(36,"mat-select",16),d.oc("ngModelChange",(function(e){return t.selectedService=e}))("selectionChange",(function(e){return t.serviceSelectionChange(e.value)})),d.Wc(37,ue,2,2,"mat-option",14),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.Wc(38,pe,11,3,"div",17),d.Wc(39,ke,15,3,"div",18),d.fc(40,"div",19),d.fc(41,"button",20),d.Yc(42,"Confirm"),d.ec(),d.fc(43,"button",21),d.Yc(44,"Cancel"),d.ec(),d.ec(),d.ec(),d.ec(),d.fc(45,"mat-step",22),d.fc(46,"form",3,23),d.fc(48,"h1",5),d.fc(49,"span",6),d.Yc(50,"Guest User Info"),d.ec(),d.ec(),d.fc(51,"div",24),d.fc(52,"div",25),d.fc(53,"mat-form-field",26),d.ac(54,"input",27),d.Wc(55,Be,3,2,"mat-error",18),d.ec(),d.fc(56,"mat-form-field",26),d.ac(57,"input",28),d.Wc(58,Ie,3,2,"mat-error",18),d.ec(),d.ec(),d.Wc(59,Te,5,6,"div",29),d.ec(),d.fc(60,"h1",5),d.fc(61,"span",6),d.Yc(62,"Confirmation"),d.ec(),d.ec(),d.fc(63,"mat-dialog-content"),d.fc(64,"mat-list"),d.fc(65,"mat-list-item"),d.fc(66,"span"),d.Yc(67,"Branch"),d.ec(),d.fc(68,"span",30),d.Yc(69),d.ec(),d.ec(),d.ac(70,"mat-divider"),d.fc(71,"mat-list-item"),d.fc(72,"span"),d.Yc(73,"Service"),d.ec(),d.fc(74,"span",30),d.Yc(75),d.ec(),d.ec(),d.ac(76,"mat-divider"),d.fc(77,"mat-list-item"),d.fc(78,"span"),d.Yc(79,"Date"),d.ec(),d.fc(80,"span",30),d.Yc(81),d.ec(),d.ec(),d.ac(82,"mat-divider"),d.fc(83,"mat-list-item"),d.fc(84,"span"),d.Yc(85,"Time"),d.ec(),d.fc(86,"span",30),d.Yc(87),d.ec(),d.ec(),d.ac(88,"mat-divider"),d.fc(89,"mat-list-item"),d.fc(90,"span"),d.Yc(91,"Location"),d.ec(),d.fc(92,"span",30),d.Yc(93),d.ec(),d.ec(),d.ac(94,"mat-divider"),d.ec(),d.ec(),d.ec(),d.fc(95,"div",19),d.fc(96,"button",31),d.Yc(97,"Back"),d.ec(),d.fc(98,"button",32),d.oc("click",(function(){return t.bookNow()})),d.Yc(99,"Book Now"),d.ec(),d.fc(100,"button",21),d.Yc(101,"Cancel"),d.ec(),d.ec(),d.ec(),d.ec(),d.ec(),d.Wc(102,He,12,8,"ng-template",null,33,d.Xc),d.Wc(104,Xe,7,1,"ng-template",null,34,d.Xc)),2&e){const e=d.Jc(47);d.Nb(1),d.Ac("linear",!0),d.Nb(2),d.Ac("stepControl",t.secondFormGroup),d.Nb(1),d.Ac("formGroup",t.secondFormGroup),d.Nb(1),d.Ac("ngClass",t.row.data?"":"d-none"),d.Nb(7),d.Ac("ngIf",t.row.data&&t.serviceList.length>0),d.Nb(2),d.Ac("ngForOf",t.addonsServiceList),d.Nb(1),d.Ac("ngClass",t.row.data?"d-none":""),d.Nb(9),d.Ac("disabled",t.row.data)("value",t.selectedMerchant)("ngModel",t.selectedMerchant),d.Nb(1),d.Ac("ngForOf",t.merchantList),d.Nb(5),d.Ac("disabled",t.row.data)("ngModel",t.selectedBranch),d.Nb(1),d.Ac("ngForOf",t.branchList),d.Nb(5),d.Ac("disabled",t.row.data)("ngModel",t.selectedService),d.Nb(1),d.Ac("ngForOf",t.serviceList),d.Nb(1),d.Ac("ngIf",t.selectedService&&t.slotList.length>0&&"true"==t.selectedService.servicePersonLevelBooking),d.Nb(1),d.Ac("ngIf",t.slotList.length>0),d.Nb(4),d.Ac("mat-dialog-close","NO"),d.Nb(3),d.Ac("formGroup",t.confirmFormGroup),d.Nb(8),d.Ac("readonly",!!t.row.data),d.Nb(1),d.Ac("ngIf",t.cnfrmform.guestUserName.invalid&&(t.cnfrmform.guestUserName.dirty||t.cnfrmform.guestUserName.touched||e.submitted)),d.Nb(2),d.Ac("readonly",!!t.row.data),d.Nb(1),d.Ac("ngIf",t.cnfrmform.guestUserMobile.invalid&&(t.cnfrmform.guestUserMobile.dirty||t.cnfrmform.guestUserMobile.touched||e.submitted)),d.Nb(1),d.Ac("ngIf","true"==(null==t.selectedService?null:t.selectedService.allowRepeatedBooking)),d.Nb(10),d.Zc(t.branchInfo?t.branchInfo.branchName:""),d.Nb(6),d.Zc(t.selectedService?t.selectedService.services.serviceName:""),d.Nb(6),d.Zc(t.selectedSlot?t.selectedSlot.date:""),d.Nb(6),d.Zc(t.selectedSlot?t.selectedSlot.time:""),d.Nb(6),d.Zc(t.branchInfo?t.branchInfo.branchLocationName:""),d.Nb(7),d.Ac("mat-dialog-close","NO")}},directives:[r.e,ie.a,ie.b,P.z,P.p,P.h,c.j,ce.a,b.a,b.c,c.l,S.a,c.k,B.c,B.g,w.a,P.o,P.g,m.a,ie.d,r.d,v.c,v.d,v.a,D.b,P.c,P.v,ie.e,K.a,I.m,oe.a,se.b,se.a,B.b,ae.a,P.r,ne.b,ne.a,r.h,r.c],styles:["@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}.scrollX[_ngcontent-%COMP%], .scrollY[_ngcontent-%COMP%]{overflow:scroll;overflow:auto;scrollbar-face-color:#00546b;scrollbar-track-color:transparent;scrollbar-color:#00546b transparent}.scrollX[_ngcontent-%COMP%]::-webkit-scrollbar, .scrollY[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.scrollX[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .scrollY[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background:#00546b}.scrollX[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .scrollY[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#003a4a}.scrollX[_ngcontent-%COMP%]::-webkit-scrollbar-track, .scrollY[_ngcontent-%COMP%]::-webkit-scrollbar-track{margin:0 4px;border-radius:4px;background:transparent}.scrollX[_ngcontent-%COMP%], .scrollX[_ngcontent-%COMP%]   *[_ngcontent-%COMP%], .scrollY[_ngcontent-%COMP%], .scrollY[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{scrollbar-width:thin}.scrollX[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:auto}.scrollY[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}@keyframes highlightFocusing{0%{background:rgba(255,215,65,.5)}to{background:rgba(255,215,65,0)}}.highlightFocusing[_ngcontent-%COMP%]{animation:highlightFocusing .5s 10ms 1;animation-fill-mode:both}[_nghost-%COMP%]{display:block}header[_ngcontent-%COMP%]{align-items:center;border-radius:4px 4px 0 0;color:#fff;background:#00546b}footer[_ngcontent-%COMP%], header[_ngcontent-%COMP%]{padding:10px;display:flex}footer[_ngcontent-%COMP%]{flex-wrap:wrap;border-radius:0 0 4px 4px;border:1px solid #00546b;border-top:0 solid #00546b;background:rgba(0,84,107,.1)}footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-grow:1;flex-basis:0;max-width:100%}main[_ngcontent-%COMP%]{padding:0;background:#fff;border:1px solid #00546b}nav[_ngcontent-%COMP%]{align-items:center;border-bottom:1px solid rgba(0,84,107,.2)}nav[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none;width:calc(100% - 80px)}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:7px;flex-grow:1;margin:0 2px;font-size:16px;text-align:center;font-weight:500}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.slots[_ngcontent-%COMP%]{display:flex;padding:10px 30px;align-items:center}.slots[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{flex-grow:1}mat-chip[_ngcontent-%COMP%]{align-items:center;white-space:nowrap;justify-content:center;text-overflow:ellipsis}mat-chip.BOOKED[_ngcontent-%COMP%]{opacity:.5;background:rgba(0,0,0,.5)}mat-chip.OPEN[_ngcontent-%COMP%]{opacity:.5;background:#00546b}mat-chip.OPEN.SELECTED[_ngcontent-%COMP%]{background:green}.book-a-slot-select[_ngcontent-%COMP%]{margin-bottom:0;width:100%;margin-top:5px}.confirmarion-R[_ngcontent-%COMP%]{right:0;display:block;position:absolute}.search-content[_ngcontent-%COMP%]{display:flex!important;width:100%}.d-none[_ngcontent-%COMP%]{display:none}.employee-unavail[_ngcontent-%COMP%]{background:#ebebeb!important;color:#000!important}"]}),e})();var Je=i("VxG0"),Qe=i("R3N2");const et=["editTmpl"];function tt(e,t){if(1&e&&d.Yc(0),2&e){const e=t.row;d.bd(" ",e.bookingDate," ",e.bookingStartTime,"\n")}}const it=[{path:"list",component:(()=>{class e{constructor(e,t,i,c){this.permissionService=e,this.initializeService=t,this.headerService=i,this.authService=c,this.filterComponent=F,this.subscriptions=[],this.filter=null,this.columns=null,this.actionButtons=[{type:"New",matTooltip:"New Appoinment",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"add",dialogComponent:je,hasPermission:this.permissionService.hasPermission("New")},{type:"Info",matTooltip:this.moduleKeyModel.appointment.name+" Details",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"info",dialogComponent:N,hasPermission:this.permissionService.hasPermission("Info")},{type:"Edit",matTooltip:this.moduleKeyModel.appointment.name+" Update",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"edit",dialogComponent:je,hasPermission:this.permissionService.hasPermission("Edit")},{type:"Delete",matTooltip:this.moduleKeyModel.appointment.name+" Cancel",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"warn",matIcon:"delete",dialogComponent:u,hasPermission:this.permissionService.hasPermission("Delete")},{type:"Edit",matTooltip:this.moduleKeyModel.appointment.name+" Completed",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"done",dialogComponent:p,hasPermission:this.permissionService.hasPermission("Edit")}],this.dialogSize={width:"75%"},this.headerService.toggleSpinner(!0),this.subscriptions.push(this.initializeService.initializeCompleted$.subscribe(e=>{e&&(this.authService.userInfo&&(this.userInfo=this.authService.userInfo,(this.userInfo.userRole.roleName.toUpperCase()===n.a.merchantAdmin||this.userInfo.userRole.roleName.toUpperCase()===n.a.branchAdmin)&&(this.filter="serviceMappingBean.branch.merchantBean.merchantId=="+this.userInfo.merchant.merchantId)),this.filter&&(this.filter=`${this.filter}##bookingStatus==${s.BKG_CNF}`),this.headerService.toggleSpinner(!1))}))}ngOnInit(){this.columns=[{prop:"bookingNumber",name:"Booking Num."},{prop:"serviceMappingBean.branch.branchName",name:"Branch"},{prop:"serviceMappingBean.services.serviceName",name:"Service"},{cellTemplate:this.editTmpl,prop:"bookingDate",name:"Date & Time"},{prop:"branchServicePerson.servicePersonName",name:"Service Person"},{prop:"bookingStatus",name:"Status"}]}get moduleKeyModel(){return a.a}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(d.Zb(Je.a),d.Zb(te.a),d.Zb(C.a),d.Zb(M.a))},e.\u0275cmp=d.Tb({type:e,selectors:[["app-appoinment-list"]],viewQuery:function(e,t){var i;1&e&&d.Sc(et,!0),2&e&&d.Ic(i=d.pc())&&(t.editTmpl=i.first)},decls:3,vars:8,consts:[[3,"inSection","inColumns","inactionButtons","moduleDisplayName","inDialogSize","filterSction","loadDataInitial","inListFilter"],["editTmpl",""]],template:function(e,t){1&e&&(d.ac(0,"app-manage-grid",0),d.Wc(1,tt,1,2,"ng-template",null,1,d.Xc)),2&e&&d.Ac("inSection",t.moduleKeyModel.appointment.key)("inColumns",t.columns)("inactionButtons",t.actionButtons)("moduleDisplayName",t.moduleKeyModel.appointment.name)("inDialogSize",t.dialogSize)("filterSction",t.filterComponent)("loadDataInitial",!0)("inListFilter",t.filter)},directives:[Qe.a],styles:[""]}),e})()}];let ct=(()=>{class e{}return e.\u0275mod=d.Xb({type:e}),e.\u0275inj=d.Wb({factory:function(t){return new(t||e)},imports:[[o.e.forChild(it)],o.e]}),e})();var ot=i("pKmL"),st=i("rsRi"),at=i("YUcS");let nt=(()=>{class e{}return e.\u0275mod=d.Xb({type:e}),e.\u0275inj=d.Wb({factory:function(t){return new(t||e)},imports:[[c.c,ct,ot.a,st.a,P.j,P.u,at.a],at.a]}),e})()}}]);