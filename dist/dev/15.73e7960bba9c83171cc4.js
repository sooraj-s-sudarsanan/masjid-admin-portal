(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{HboH:function(e,i,t){"use strict";t.r(i),t.d(i,"MappingModule",(function(){return Ze}));var c=t("SVse"),o=t("iInd"),r=t("zViY"),n=t("2cce"),a=t("iELJ"),s=t("8Y7J"),l=t("SqCe"),d=t("BSbQ"),m=t("Dxy4");let p=(()=>{class e{constructor(e,i){this.dialogRef=e,this.row=i}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)(s.Zb(a.g),s.Zb(a.a))},e.\u0275cmp=s.Tb({type:e,selectors:[["app-mapping-details"]],decls:57,vars:8,consts:[[1,""],["mat-dialog-title","",1,"w-100","m-r-auto","dialog-title-h1"],[1,"m-y-10"],[1,"w-100","f-medium","d-block","m-b-5","o-50"],[1,"w-100","font-weight-bold"],["mat-dialog-actions",""],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,i){1&e&&(s.fc(0,"header",0),s.fc(1,"h1",1),s.Yc(2,"Details"),s.ec(),s.ec(),s.fc(3,"mat-dialog-content"),s.fc(4,"mat-list"),s.fc(5,"mat-list-item"),s.fc(6,"div",2),s.fc(7,"small",3),s.Yc(8,"Branch:"),s.ec(),s.fc(9,"div",4),s.Yc(10),s.ec(),s.ec(),s.ec(),s.ac(11,"mat-divider"),s.fc(12,"mat-list-item"),s.fc(13,"div",2),s.fc(14,"small",3),s.Yc(15,"Service :"),s.ec(),s.fc(16,"div",4),s.Yc(17),s.ec(),s.ec(),s.ec(),s.ac(18,"mat-divider"),s.fc(19,"mat-list-item"),s.fc(20,"div",2),s.fc(21,"small",3),s.Yc(22,"Booking Allowed :"),s.ec(),s.fc(23,"div",4),s.Yc(24),s.ec(),s.ec(),s.ec(),s.ac(25,"mat-divider"),s.fc(26,"mat-list-item"),s.fc(27,"div",2),s.fc(28,"small",3),s.Yc(29,"Start Time :"),s.ec(),s.fc(30,"div",4),s.Yc(31),s.ec(),s.ec(),s.ec(),s.ac(32,"mat-divider"),s.fc(33,"mat-list-item"),s.fc(34,"div",2),s.fc(35,"small",3),s.Yc(36,"End Time :"),s.ec(),s.fc(37,"div",4),s.Yc(38),s.ec(),s.ec(),s.ec(),s.ac(39,"mat-divider"),s.fc(40,"mat-list-item"),s.fc(41,"div",2),s.fc(42,"small",3),s.Yc(43,"Person Level Booking :"),s.ec(),s.fc(44,"div",4),s.Yc(45),s.ec(),s.ec(),s.ec(),s.ac(46,"mat-divider"),s.fc(47,"mat-list-item"),s.fc(48,"div",2),s.fc(49,"small",3),s.Yc(50,"Price :"),s.ec(),s.fc(51,"div",4),s.Yc(52),s.ec(),s.ec(),s.ec(),s.ac(53,"mat-divider"),s.ec(),s.ec(),s.fc(54,"div",5),s.fc(55,"button",6),s.Yc(56,"Close"),s.ec(),s.ec()),2&e&&(s.Nb(10),s.Zc(i.row.data.branch.branchName),s.Nb(7),s.Zc(i.row.data.services.serviceName),s.Nb(7),s.Zc(i.row.data.numberOfBookingAllowed),s.Nb(7),s.Zc(i.row.data.servicePersonStartTime),s.Nb(7),s.Zc(i.row.data.servicePersonEndTime),s.Nb(7),s.Zc(i.row.data.servicePersonLevelBooking),s.Nb(7),s.Zc(i.row.data.servicePrice),s.Nb(3),s.Ac("mat-dialog-close","NO"))},directives:[a.h,a.e,l.a,l.c,d.a,a.c,m.a,a.d],styles:[""]}),e})();var u=t("khRK"),f=t("w9WL"),g=t("2Vo4"),h=t("SXVO"),v=t("s7LF"),b=t("6xPc"),w=t("jKJn"),S=t("dzPw"),T=t("Q2Ze"),I=t("e6WT"),P=t("pMoy"),k=t("cw5Z");function A(e,i){1&e&&(s.fc(0,"span",19),s.Yc(1," Number of booking allowed is required "),s.ec())}function M(e,i){if(1&e&&(s.fc(0,"mat-error"),s.Wc(1,A,2,0,"span",18),s.Yc(2,". "),s.ec()),2&e){const e=s.sc();s.Nb(1),s.Ac("ngIf",e.eform.numberOfBookingAllowed.errors.required)}}function N(e,i){1&e&&(s.fc(0,"span",19),s.Yc(1," Start time is required "),s.ec())}function B(e,i){if(1&e&&(s.fc(0,"mat-error"),s.Wc(1,N,2,0,"span",18),s.ec()),2&e){const e=s.sc();s.Nb(1),s.Ac("ngIf",e.eform.servicePersonStartTime.errors.required)}}function C(e,i){1&e&&(s.fc(0,"span",19),s.Yc(1," End time is required "),s.ec())}function y(e,i){if(1&e&&(s.fc(0,"mat-error"),s.Wc(1,C,2,0,"span",18),s.ec()),2&e){const e=s.sc();s.Nb(1),s.Ac("ngIf",e.eform.servicePersonEndTime.errors.required)}}function L(e,i){1&e&&(s.fc(0,"span",19),s.Yc(1," Avg. Duration is required "),s.ec())}function E(e,i){if(1&e&&(s.fc(0,"mat-error"),s.Wc(1,L,2,0,"span",18),s.ec()),2&e){const e=s.sc();s.Nb(1),s.Ac("ngIf",e.eform.servicePersonAvgDuration.errors.required)}}function R(e,i){1&e&&(s.fc(0,"span",19),s.Yc(1," Service Price is required "),s.ec())}function x(e,i){if(1&e&&(s.fc(0,"mat-error"),s.Wc(1,R,2,0,"span",18),s.Yc(2,". "),s.ec()),2&e){const e=s.sc();s.Nb(1),s.Ac("ngIf",e.eform.servicePrice.errors.required)}}let Y=(()=>{class e{constructor(e,i,t,c,o,r){this.dialogRef=e,this.row=i,this.formBuilder=t,this.manageGridService=c,this.alertService=o,this.adminBaseService=r}ngOnInit(){this.row.data||(this.alertService.open(h.a.ERROR,"Mapping data are missing."),this.dialogRef.close()),this.form=this.formBuilder.group({serviceMappingId:[this.row.data?this.row.data.serviceMappingId:"",[v.x.required]],numberOfBookingAllowed:[this.row.data?this.row.data.numberOfBookingAllowed:"",[v.x.required]],servicePersonLevelBooking:[this.row.data?this.row.data.servicePersonLevelBooking:""],servicePersonStartTime:[this.row.data?this.row.data.servicePersonStartTime:"",[v.x.required]],servicePersonEndTime:[this.row.data?this.row.data.servicePersonEndTime:"",[v.x.required]],servicePersonAvgDuration:[this.row.data?this.row.data.servicePersonAvgDuration:"",[v.x.required]],servicePrice:[this.row.data?this.row.data.servicePrice:""],services:this.formBuilder.group({serviceId:[this.row.data?this.row.data.serviceId:"",[v.x.required]]}),branch:this.formBuilder.group({branchId:[this.row.data?this.row.data.branchId:null,[v.x.required]]}),servicePerson:[this.row.data?this.row.data.servicePerson:[]],offers:[this.row.data?this.row.data.offers:null],allowRepeatedBooking:[!!this.row.data&&"true"==this.row.data.allowRepeatedBooking]})}get eform(){return this.form.controls}get moduleKeyModel(){return r.a}onSubmit(){if(this.form.invalid)return this.alertService.open(h.a.ERROR,"Please check mandatory fields or invalid values"),!1;this.manageGridService.addORupdateRowData(r.a.mapping.key,!1,this.form.value).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.dialogRef.close({rowValue:e.result.data}),this.alertService.open(h.a.SUCCESS,r.a.mapping.name+" updated successfully"))},e=>{})}}return e.\u0275fac=function(i){return new(i||e)(s.Zb(a.g),s.Zb(a.a),s.Zb(v.d),s.Zb(b.a),s.Zb(w.a),s.Zb(S.a))},e.\u0275cmp=s.Tb({type:e,selectors:[["app-individual-edit"]],decls:34,vars:13,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title","",1,"h3","title"],["color","accent",1,"full-width"],["type","number","matInput","","placeholder","Number of booking allowed","autocomplete","off","formControlName","numberOfBookingAllowed","required",""],[4,"ngIf"],[1,"full-width"],["formControlName","servicePersonLevelBooking",1,"example-margin"],["formControlName","allowRepeatedBooking",1,"example-margin"],["matInput","","readonly","","placeholder","Start Time","autocomplete","off","formControlName","servicePersonStartTime","required","",3,"ngxTimepicker"],[3,"minutesGap","appendToInput"],["appendedToInput",""],["matInput","","placeholder","End Time","autocomplete","off","formControlName","servicePersonEndTime","required","","readonly","",3,"ngxTimepicker"],["appendedToInput2",""],["type","number","matInput","","placeholder","Avg. Duration","autocomplete","off","formControlName","servicePersonAvgDuration","required",""],["type","number","matInput","","placeholder","Service Price","autocomplete","off","formControlName","servicePrice"],["mat-dialog-actions",""],["type","submit","mat-raised-button","","color","primary"],["type","button","mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"],["class","alert-danger",4,"ngIf"],[1,"alert-danger"]],template:function(e,i){if(1&e&&(s.fc(0,"form",0),s.oc("ngSubmit",(function(){return i.onSubmit()})),s.fc(1,"h1",1),s.Yc(2,"Edit Mapping"),s.ec(),s.fc(3,"mat-dialog-content"),s.fc(4,"mat-form-field",2),s.ac(5,"input",3),s.Wc(6,M,3,1,"mat-error",4),s.ec(),s.fc(7,"div",5),s.fc(8,"mat-checkbox",6),s.Yc(9,"Personal level booking"),s.ec(),s.ec(),s.fc(10,"div",5),s.fc(11,"mat-checkbox",7),s.Yc(12,"Allow Repeated Booking"),s.ec(),s.ec(),s.fc(13,"mat-form-field",2),s.ac(14,"input",8),s.Wc(15,B,2,1,"mat-error",4),s.ec(),s.ac(16,"ngx-material-timepicker",9,10),s.fc(18,"mat-form-field",2),s.ac(19,"input",11),s.Wc(20,y,2,1,"mat-error",4),s.ec(),s.ac(21,"ngx-material-timepicker",9,12),s.fc(23,"mat-form-field",2),s.ac(24,"input",13),s.Wc(25,E,2,1,"mat-error",4),s.ec(),s.fc(26,"mat-form-field",2),s.ac(27,"input",14),s.Wc(28,x,3,1,"mat-error",4),s.ec(),s.ec(),s.fc(29,"div",15),s.fc(30,"button",16),s.Yc(31,"Submit"),s.ec(),s.fc(32,"button",17),s.Yc(33,"Cancel"),s.ec(),s.ec(),s.ec()),2&e){const e=s.Jc(17),t=s.Jc(22);s.Ac("formGroup",i.form),s.Nb(6),s.Ac("ngIf",i.eform.numberOfBookingAllowed.invalid&&(i.eform.numberOfBookingAllowed.dirty||i.eform.numberOfBookingAllowed.touched)),s.Nb(8),s.Ac("ngxTimepicker",e),s.Nb(1),s.Ac("ngIf",i.eform.servicePersonStartTime.invalid&&(i.eform.servicePersonStartTime.dirty||i.eform.servicePersonStartTime.touched)),s.Nb(1),s.Ac("minutesGap",5)("appendToInput",!0),s.Nb(3),s.Ac("ngxTimepicker",t),s.Nb(1),s.Ac("ngIf",i.eform.servicePersonEndTime.invalid&&(i.eform.servicePersonEndTime.dirty||i.eform.servicePersonEndTime.touched)),s.Nb(1),s.Ac("minutesGap",5)("appendToInput",!0),s.Nb(4),s.Ac("ngIf",i.eform.servicePersonAvgDuration.invalid&&(i.eform.servicePersonAvgDuration.dirty||i.eform.servicePersonAvgDuration.touched)),s.Nb(3),s.Ac("ngIf",i.eform.servicePrice.invalid&&(i.eform.servicePrice.dirty||i.eform.servicePrice.touched)),s.Nb(4),s.Ac("mat-dialog-close","NO")}},directives:[v.z,v.p,v.h,a.h,a.e,T.c,v.t,I.b,v.c,v.o,v.g,v.v,c.l,P.a,k.c,k.a,a.c,m.a,a.d,T.b],styles:[""]}),e})(),D=(()=>{class e{constructor(e,i,t,c){this.dialogRef=e,this.row=i,this.manageGridService=t,this.alertService=c}ngOnInit(){}deleteRowData(){this.row&&this.manageGridService.deleteRowData(r.a.mapping.key,{serviceMappingId:this.row.data.serviceMappingId}).subscribe(e=>{e&&e.result&&"SUCCESS"===e.result.status&&(this.dialogRef.close({action:"Delete",serviceMappingId:this.row.data.serviceMappingId}),this.alertService.open(h.a.SUCCESS,e.result.data))},e=>{console.log(e)})}}return e.\u0275fac=function(i){return new(i||e)(s.Zb(a.g),s.Zb(a.a),s.Zb(b.a),s.Zb(w.a))},e.\u0275cmp=s.Tb({type:e,selectors:[["app-mapping-delete"]],decls:10,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,i){1&e&&(s.fc(0,"h1",0),s.Yc(1,"Confirmation"),s.ec(),s.fc(2,"mat-dialog-content"),s.fc(3,"p"),s.Yc(4,"Do you want remove mapping?"),s.ec(),s.ec(),s.fc(5,"div",1),s.fc(6,"button",2),s.oc("click",(function(){return i.deleteRowData()})),s.Yc(7,"Yes"),s.ec(),s.fc(8,"button",3),s.Yc(9,"No"),s.ec(),s.ec()),2&e&&(s.Nb(8),s.Ac("mat-dialog-close","NO"))},directives:[a.h,a.e,a.c,m.a,a.d],styles:[""]}),e})();var O=t("XOzN"),Z=t("mL9m"),W=t("y8gV"),q=t("sdPG"),_=t("PDjf"),V=t("VDRc"),G=t("ZTz/"),z=t("ZFy/"),F=t("UhP/"),U=t("Tj54");const X=["selectService"],K=["byPerson"],$=["bookingAllowed"],H=["allowRepeatedBooking"],J=["startTime"],j=["endTime"],Q=["duration"],ee=["price"],ie=["mappingAction"];function te(e,i){if(1&e&&(s.fc(0,"mat-option",23),s.Yc(1),s.ec()),2&e){const e=i.$implicit;s.Ac("value",e.merchantId),s.Nb(1),s.ad("",e.merchantName," ")}}function ce(e,i){if(1&e&&(s.fc(0,"mat-option",23),s.Yc(1),s.ec()),2&e){const e=i.$implicit;s.Ac("value",e.branchId),s.Nb(1),s.ad("",e.branchName," ")}}function oe(e,i){if(1&e&&(s.fc(0,"mat-option",23),s.Yc(1),s.ec()),2&e){const e=i.$implicit;s.Ac("value",e.categoryId),s.Nb(1),s.ad("",e.categoryName," ")}}function re(e,i){if(1&e){const e=s.gc();s.fc(0,"mat-checkbox",26),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.selected=i})),s.Yc(1),s.ec()}if(2&e){const e=s.sc().row;s.Ac("checked",e.selected)("ngModel",e.selected),s.Nb(1),s.ad("",e.serviceName," ")}}function ne(e,i){if(1&e&&(s.fc(0,"span"),s.fc(1,"mat-icon",27),s.Yc(2,"done"),s.ec(),s.Yc(3),s.ec()),2&e){const e=s.sc().row;s.Nb(3),s.ad("\xa0",e.serviceName," ")}}function ae(e,i){if(1&e&&(s.Wc(0,re,2,3,"mat-checkbox",24),s.Wc(1,ne,4,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function se(e,i){if(1&e){const e=s.gc();s.fc(0,"mat-checkbox",29),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.servicePersonLevelBooking=i})),s.ec()}if(2&e){const e=s.sc().row;s.Ac("disabled",!e.selected)("checked",e.servicePersonLevelBooking)("ngModel",e.servicePersonLevelBooking)}}function le(e,i){if(1&e&&(s.fc(0,"span"),s.fc(1,"mat-icon",27),s.Yc(2),s.ec(),s.ec()),2&e){const e=s.sc().row;s.Nb(2),s.ad("",e.servicePersonLevelBooking?"done":"close"," ")}}function de(e,i){if(1&e&&(s.Wc(0,se,1,3,"mat-checkbox",28),s.Wc(1,le,3,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function me(e,i){if(1&e){const e=s.gc();s.fc(0,"input",31),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.numberOfBookingAllowed=i})),s.ec()}if(2&e){const e=s.sc().row;s.Ac("disabled",!e.selected)("value",e.numberOfBookingAllowed)("ngModel",e.numberOfBookingAllowed)}}function pe(e,i){if(1&e&&(s.fc(0,"span"),s.Yc(1),s.ec()),2&e){const e=s.sc().row;s.Nb(1),s.Zc(e.numberOfBookingAllowed)}}function ue(e,i){if(1&e&&(s.Wc(0,me,1,3,"input",30),s.Wc(1,pe,2,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function fe(e,i){if(1&e){const e=s.gc();s.fc(0,"mat-checkbox",29),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.allowRepeatedBooking=i})),s.ec()}if(2&e){const e=s.sc().row;s.Ac("disabled",!e.selected)("checked",e.allowRepeatedBooking)("ngModel",e.allowRepeatedBooking)}}function ge(e,i){if(1&e&&(s.fc(0,"span"),s.fc(1,"mat-icon",27),s.Yc(2),s.ec(),s.ec()),2&e){const e=s.sc().row;s.Nb(2),s.ad("","true"==e.allowRepeatedBooking?"done":"close"," ")}}function he(e,i){if(1&e&&(s.Wc(0,fe,1,3,"mat-checkbox",28),s.Wc(1,ge,3,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function ve(e,i){if(1&e&&(s.fc(0,"span"),s.Yc(1),s.ec()),2&e){const e=s.sc().row;s.Nb(1),s.Zc(e.servicePersonStartTime)}}function be(e,i){if(1&e){const e=s.gc();s.fc(0,"input",32),s.oc("ngModelChange",(function(t){return s.Nc(e),i.row.servicePersonStartTime=t})),s.ec(),s.Wc(1,ve,2,1,"span",25),s.ac(2,"ngx-material-timepicker",33,34)}if(2&e){const e=i.row,t=s.Jc(3);s.Pb(e.serviceMappingId?"d-none":""),s.Ac("value",e.servicePersonStartTime)("ngModel",e.servicePersonStartTime)("disabled",!e.selected)("ngxTimepicker",t),s.Nb(1),s.Ac("ngIf",e.serviceMappingId),s.Nb(1),s.Ac("minutesGap",5)("appendToInput",!0)}}function we(e,i){if(1&e&&(s.fc(0,"span"),s.Yc(1),s.ec()),2&e){const e=s.sc().row;s.Nb(1),s.Zc(e.servicePersonEndTime)}}function Se(e,i){if(1&e){const e=s.gc();s.fc(0,"input",35),s.oc("ngModelChange",(function(t){return s.Nc(e),i.row.servicePersonEndTime=t})),s.ec(),s.Wc(1,we,2,1,"span",25),s.ac(2,"ngx-material-timepicker",33,36)}if(2&e){const e=i.row,t=s.Jc(3);s.Pb(e.serviceMappingId?"d-none":""),s.Ac("value",e.servicePersonEndTime)("ngModel",e.servicePersonEndTime)("disabled",!e.selected)("ngxTimepicker",t),s.Nb(1),s.Ac("ngIf",e.serviceMappingId),s.Nb(1),s.Ac("minutesGap",5)("appendToInput",!0)}}function Te(e,i){if(1&e){const e=s.gc();s.fc(0,"input",38),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.servicePersonAvgDuration=i})),s.ec()}if(2&e){const e=s.sc().row;s.Ac("disabled",!e.selected)("value",e.servicePersonAvgDuration)("ngModel",e.servicePersonAvgDuration)}}function Ie(e,i){if(1&e&&(s.fc(0,"span"),s.Yc(1),s.ec()),2&e){const e=s.sc().row;s.Nb(1),s.Zc(e.servicePersonAvgDuration)}}function Pe(e,i){if(1&e&&(s.Wc(0,Te,1,3,"input",37),s.Wc(1,Ie,2,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function ke(e,i){if(1&e){const e=s.gc();s.fc(0,"input",38),s.oc("ngModelChange",(function(i){return s.Nc(e),s.sc().row.servicePrice=i})),s.ec()}if(2&e){const e=s.sc().row;s.Ac("disabled",!e.selected)("value",e.servicePrice)("ngModel",e.servicePrice)}}function Ae(e,i){if(1&e&&(s.fc(0,"span"),s.Yc(1),s.ec()),2&e){const e=s.sc().row;s.Nb(1),s.Zc(e.servicePrice)}}function Me(e,i){if(1&e&&(s.Wc(0,ke,1,3,"input",37),s.Wc(1,Ae,2,1,"span",25)),2&e){const e=i.row;s.Ac("ngIf",!e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}function Ne(e,i){if(1&e){const e=s.gc();s.fc(0,"a",40),s.oc("click",(function(){s.Nc(e);const i=s.sc().row;return s.sc().editMapping(i)})),s.fc(1,"mat-icon",41),s.Yc(2,"edit"),s.ec(),s.ec()}2&e&&s.Ac("matTooltip","Edit Mapping")("matTooltipPosition","above")}function Be(e,i){if(1&e){const e=s.gc();s.fc(0,"a",40),s.oc("click",(function(){s.Nc(e);const i=s.sc().row;return s.sc().removeMapping(i)})),s.fc(1,"mat-icon",42),s.Yc(2,"delete"),s.ec(),s.ec()}2&e&&s.Ac("matTooltip","Remove Mapping")("matTooltipPosition","above")}function Ce(e,i){if(1&e&&(s.Wc(0,Ne,3,2,"a",39),s.Wc(1,Be,3,2,"a",39)),2&e){const e=i.row;s.Ac("ngIf",e.serviceMappingId),s.Nb(1),s.Ac("ngIf",e.serviceMappingId)}}let ye=(()=>{class e{constructor(e,i,t,c,o,r,n,a,s,l,d){this.dialog=e,this.dialogRef=i,this.row=t,this.formBuilder=c,this.manageGridService=o,this.headerService=r,this.adminBaseService=n,this.alertService=a,this.dropDownService=s,this.authService=l,this.initializeService=d,this.merchantList=[],this.branchList=[],this.categoryList=[],this.action="Add",this.SelectionType=f.d,this.serviceList=[],this.columns=[],this.selectedMerchantText="Choose Merchant",this.selectedBranchText="Choose Branch",this.selectedCategoryText="Choose Category",this.isLoaded$=new g.a(!1),this.subscriptions=[],this.timePattern=new RegExp("^([0-1]?[0-9]|2[0-3]):[0-5][0-9]s?[AaPp][Mm]$")}ngOnInit(){this.headerService.toggleSpinner(!0),this.subscriptions.push(this.initializeService.initializeCompleted$.subscribe(e=>{e&&this.authService.userInfo&&(this.userInfo=this.authService.userInfo,this.isLoaded$.next(!0))})),this.subscriptions.push(this.isLoaded$.subscribe(e=>{e&&(this.columns=[{name:"Select",cellTemplate:this.selectServiceTmplt},{name:"Booking By Service Person",cellTemplate:this.byPeronTmplt},{name:"No. Booking Allowed",cellTemplate:this.bookingAllowedTmplt},{name:"Repeat Booking",cellTemplate:this.allowRepeatedBookingTmplt},{name:"Start Time",cellTemplate:this.startTimeTmplt},{name:"End Time",cellTemplate:this.endTimeTmplt},{name:"Duration (in min)",cellTemplate:this.durationTmplt},{name:"Price",cellTemplate:this.priceTmplt},{name:"",cellTemplate:this.mappingActionTmplt}],this.headerService.toggleSpinner(!0),this.subscriptions.push(this.dropDownService.getMerchant("ADM_LIST_MERCHANTS",null).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.merchantList=e.result.data,this.row&&this.row.data&&(this.merchantSelectionChange(this.row.data.branch.merchantBean.merchantId),this.selectedMerchant=this.row.data.branch.merchantBean.merchantId,this.selectedMerchantText=this.row.data.branch.merchantBean.merchantName)),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)})))}))}merchantSelectionChange(e){if(this.branchList=[],e){const i={filter:"merchantBean.merchantId=="+e};setTimeout(()=>{this.headerService.toggleSpinner(!0)},100),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_MERCHANT_BRANCHES",i).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.branchList=e.result.data,this.row&&this.row.data&&(this.branchSelectionChange(this.row.data.branch.branchId),this.selectedBranch=this.row.data.branch.branchId,this.selectedBranchText=this.row.data.branch.branchName)),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}}branchSelectionChange(e){if(this.serviceList=[],e&&this.branchList){const i=this.branchList.find(i=>i.branchId==e);i&&(this.categoryList=i.merchantBean.category,this.selectedBranch=e,this.row&&this.row.data&&(this.categorySelectionChange(this.row.data.services.category.categoryId),this.selectedCategory=this.row.data.services.category.categoryId,this.selectedCategoryText=this.row.data.services.category.categoryName))}}categorySelectionChange(e){if(e){let i={filter:"category.categoryId=="+e};setTimeout(()=>{this.headerService.toggleSpinner(!0)},100),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_SERVICE",i).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(e.result.data.map(e=>{e.servicePersonLevelBooking=!1,e.selected=!1,e.numberOfBookingAllowed=null,e.servicePersonAvgDuration=null,e.servicePersonEndTime=null,e.servicePersonStartTime=null,e.servicePrice=null,e.allowRepeatedBooking=!1,e.type="new"}),this.serviceList=e.result.data),i={filter:"branch.branchId=="+this.selectedBranch},this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_LIST_SERVICE_MAPPING",i).subscribe(e=>{e&&e&&"SUCCESS"===e.result.status&&this.serviceList.length>0&&e.result.data&&(this.action="Edit",e.result.data.forEach(e=>{const i=this.serviceList.find(i=>i.serviceId===e.services.serviceId);i&&(i.selected=!0,i.servicePersonLevelBooking=Boolean(JSON.parse(e.servicePersonLevelBooking)),i.numberOfBookingAllowed=e.numberOfBookingAllowed,i.servicePersonAvgDuration=e.servicePersonAvgDuration,i.servicePersonEndTime=e.servicePersonEndTime,i.servicePersonStartTime=e.servicePersonStartTime,i.servicePerson=e.servicePerson,i.serviceMappingId=e.serviceMappingId,i.servicePrice=e.servicePrice,i.servicePerson=e.servicePerson,i.offers=e.offers,i.branchId=e.branch.branchId,i.allowRepeatedBooking=e.allowRepeatedBooking,i.type="edit")})),this.headerService.toggleSpinner(!1)})))},e=>{this.headerService.toggleSpinner(!1)}))}}get moduleKeyModel(){return r.a}cancel(e){this.dialogRef.close({action:"Reload"})}submit(e){let i=[];if(this.serviceList.forEach(e=>{if(e.selected&&"new"==e.type){if(!(e.numberOfBookingAllowed&&e.servicePersonStartTime&&e.servicePersonEndTime&&e.servicePersonAvgDuration))return i=[],null==e.numberOfBookingAllowed||void 0===e.numberOfBookingAllowed?this.alertService.open(h.a.ERROR,e.serviceName+" service, booking allowed is required"):null==e.servicePersonStartTime||void 0===e.servicePersonStartTime?this.alertService.open(h.a.ERROR,e.serviceName+" service, booking start time is required"):null==e.servicePersonEndTime||void 0===e.servicePersonEndTime?this.alertService.open(h.a.ERROR,e.serviceName+" service, booking end time is required"):null!=e.servicePersonAvgDuration&&void 0!==e.servicePersonAvgDuration||this.alertService.open(h.a.ERROR,e.serviceName+" service, avg. duration is required"),!1;{const t={services:e,branch:this.branchList.find(e=>e.branchId=this.selectedBranch),servicePersonLevelBooking:e.servicePersonLevelBooking,servicePersonDisplayName:"",numberOfBookingAllowed:e.numberOfBookingAllowed,servicePersonStartTime:e.servicePersonStartTime,servicePersonEndTime:e.servicePersonEndTime,servicePersonAvgDuration:e.servicePersonAvgDuration,servicePrice:e.servicePrice,servicePerson:e.servicePerson,offers:e.offers,allowRepeatedBooking:e.allowRepeatedBooking};this.row&&this.row.data&&(t.serviceMappingId=e.serviceMappingId),i.push(t)}}}),i.length>0){const e={listToProcess:i};this.headerService.toggleSpinner(!0),this.subscriptions.push(this.adminBaseService.requestSubmit("ADM_ADD_SERVICE_MAPPING",e).subscribe(e=>{e&&(e.result&&"SUCCESS"===e.result.status&&(this.dialogRef.close({action:"Reload"}),this.alertService.open(h.a.SUCCESS,`${r.a.mapping.name} ${this.row.data?"edited":"created"} successfully`)),this.headerService.toggleSpinner(!1))},e=>{this.headerService.toggleSpinner(!1)}))}}editMapping(e){e&&this.dialog.open(Y,{disableClose:!0,width:"500px",maxHeight:"90vh",data:{data:e}}).afterClosed().subscribe(e=>{if(e.rowValue&&e.rowValue.serviceMappingId&&this.serviceList.length>0){const i=this.serviceList.findIndex(i=>i.serviceMappingId===e.rowValue.serviceMappingId);i>-1&&(this.serviceList[i].numberOfBookingAllowed=e.rowValue.numberOfBookingAllowed,this.serviceList[i].servicePersonAvgDuration=e.rowValue.servicePersonAvgDuration,this.serviceList[i].servicePersonEndTime=e.rowValue.servicePersonEndTime,this.serviceList[i].servicePersonLevelBooking="true"==e.rowValue.servicePersonLevelBooking,this.serviceList[i].servicePersonStartTime=e.rowValue.servicePersonStartTime,this.serviceList[i].servicePrice=e.rowValue.servicePrice,this.serviceList[i].allowRepeatedBooking=e.rowValue.allowRepeatedBooking)}})}removeMapping(e){e&&this.dialog.open(D,{disableClose:!0,width:"500px",maxHeight:"90vh",data:{data:e}}).afterClosed().subscribe(e=>{if(e&&e&&e.serviceMappingId){const i=this.serviceList.findIndex(i=>i.serviceMappingId===e.serviceMappingId);i>-1&&(this.serviceList[i].servicePersonLevelBooking=!1,this.serviceList[i].selected=!1,this.serviceList[i].numberOfBookingAllowed=null,this.serviceList[i].servicePersonAvgDuration=null,this.serviceList[i].servicePersonEndTime=null,this.serviceList[i].servicePersonStartTime=null,this.serviceList[i].servicePrice=null,this.serviceList[i].type="new",this.serviceList[i].serviceMappingId=null)}})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(i){return new(i||e)(s.Zb(a.b),s.Zb(a.g),s.Zb(a.a),s.Zb(v.d),s.Zb(b.a),s.Zb(O.a),s.Zb(S.a),s.Zb(w.a),s.Zb(Z.a),s.Zb(W.a),s.Zb(q.a))},e.\u0275cmp=s.Tb({type:e,selectors:[["app-mapping-grid-action"]],viewQuery:function(e,i){var t;1&e&&(s.Sc(X,!0),s.Sc(K,!0),s.Sc($,!0),s.Sc(H,!0),s.Sc(J,!0),s.Sc(j,!0),s.Sc(Q,!0),s.Sc(ee,!0),s.Sc(ie,!0)),2&e&&(s.Ic(t=s.pc())&&(i.selectServiceTmplt=t.first),s.Ic(t=s.pc())&&(i.byPeronTmplt=t.first),s.Ic(t=s.pc())&&(i.bookingAllowedTmplt=t.first),s.Ic(t=s.pc())&&(i.allowRepeatedBookingTmplt=t.first),s.Ic(t=s.pc())&&(i.startTimeTmplt=t.first),s.Ic(t=s.pc())&&(i.endTimeTmplt=t.first),s.Ic(t=s.pc())&&(i.durationTmplt=t.first),s.Ic(t=s.pc())&&(i.priceTmplt=t.first),s.Ic(t=s.pc())&&(i.mappingActionTmplt=t.first))},decls:50,vars:18,consts:[["mat-dialog-title","",1,"h3","title"],[1,"ib-m"],[1,"m-t-5","m-b-5"],[1,"row"],["fxLayout","row","fxFill",""],["fxFlex","30"],["appearance","fill",1,"full-width-80"],[3,"disabled","matTooltip","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"p-t-10","p-b-10",2,"min-height","200px"],["rowHeight","50px",1,"material","fullscreen",3,"rows","columns","columnMode","headerHeight"],["mat-dialog-actions",""],["type","submit","mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn","cdkFocusInitial","",3,"click"],["selectService",""],["byPerson",""],["bookingAllowed",""],["allowRepeatedBooking",""],["startTime",""],["endTime",""],["duration",""],["price",""],["mappingAction",""],[3,"value"],["class","example-margin",3,"checked","ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],[1,"example-margin",3,"checked","ngModel","ngModelChange"],[1,"menuIcon"],["class","example-margin",3,"disabled","checked","ngModel","ngModelChange",4,"ngIf"],[1,"example-margin",3,"disabled","checked","ngModel","ngModelChange"],["class","bb-1","matInput","","type","number","autocomplete","off",3,"disabled","value","ngModel","ngModelChange",4,"ngIf"],["matInput","","type","number","autocomplete","off",1,"bb-1",3,"disabled","value","ngModel","ngModelChange"],["placeholder","Start Time","aria-label","Start Time","readonly","",1,"w-100",3,"value","ngModel","disabled","ngxTimepicker","ngModelChange"],[3,"minutesGap","appendToInput"],["appendedToInput",""],["placeholder","End Time","aria-label","End Time","readonly","",1,"w-100",3,"value","ngModel","disabled","ngxTimepicker","ngModelChange"],["appendedToInput2",""],["type","number","class","bb-1","matInput","","autocomplete","off",3,"disabled","value","ngModel","ngModelChange",4,"ngIf"],["type","number","matInput","","autocomplete","off",1,"bb-1",3,"disabled","value","ngModel","ngModelChange"],[3,"matTooltip","matTooltipPosition","click",4,"ngIf"],[3,"matTooltip","matTooltipPosition","click"],["color","primary",1,"menuIcon"],["color","warn",1,"menuIcon"]],template:function(e,i){1&e&&(s.fc(0,"h1",0),s.fc(1,"span",1),s.Yc(2),s.ec(),s.ec(),s.fc(3,"mat-card",2),s.fc(4,"div",3),s.fc(5,"div",4),s.fc(6,"div",5),s.fc(7,"mat-form-field",6),s.fc(8,"mat-label"),s.Yc(9,"Choose Merchant"),s.ec(),s.fc(10,"mat-select",7),s.oc("ngModelChange",(function(e){return i.selectedMerchant=e}))("selectionChange",(function(e){return i.merchantSelectionChange(e.value)})),s.Wc(11,te,2,2,"mat-option",8),s.ec(),s.ec(),s.ec(),s.fc(12,"div",5),s.fc(13,"mat-form-field",6),s.fc(14,"mat-label"),s.Yc(15,"Choose Branch"),s.ec(),s.fc(16,"mat-select",7),s.oc("ngModelChange",(function(e){return i.selectedBranch=e}))("selectionChange",(function(e){return i.branchSelectionChange(e.value)})),s.Wc(17,ce,2,2,"mat-option",8),s.ec(),s.ec(),s.ec(),s.fc(18,"div",5),s.fc(19,"mat-form-field",6),s.fc(20,"mat-label"),s.Yc(21,"Choose Category"),s.ec(),s.fc(22,"mat-select",7),s.oc("ngModelChange",(function(e){return i.selectedCategory=e}))("selectionChange",(function(e){return i.categorySelectionChange(e.value)})),s.Wc(23,oe,2,2,"mat-option",8),s.ec(),s.ec(),s.ec(),s.ec(),s.ec(),s.ec(),s.fc(24,"mat-dialog-content",9),s.fc(25,"div",3),s.ac(26,"ngx-datatable",10),s.ec(),s.ec(),s.fc(27,"div",11),s.fc(28,"button",12),s.oc("click",(function(e){return i.submit(e)})),s.Yc(29,"Submit"),s.ec(),s.fc(30,"button",13),s.oc("click",(function(e){return i.cancel(e)})),s.Yc(31,"Cancel"),s.ec(),s.ec(),s.Wc(32,ae,2,2,"ng-template",null,14,s.Xc),s.Wc(34,de,2,2,"ng-template",null,15,s.Xc),s.Wc(36,ue,2,2,"ng-template",null,16,s.Xc),s.Wc(38,he,2,2,"ng-template",null,17,s.Xc),s.Wc(40,be,4,9,"ng-template",null,18,s.Xc),s.Wc(42,Se,4,9,"ng-template",null,19,s.Xc),s.Wc(44,Pe,2,2,"ng-template",null,20,s.Xc),s.Wc(46,Me,2,2,"ng-template",null,21,s.Xc),s.Wc(48,Ce,2,2,"ng-template",null,22,s.Xc)),2&e&&(s.Nb(2),s.bd("",i.action,"\xa0",i.moduleKeyModel.mapping.name,""),s.Nb(8),s.Ac("disabled",i.row.data)("matTooltip",i.selectedMerchantText)("ngModel",i.selectedMerchant),s.Nb(1),s.Ac("ngForOf",i.merchantList),s.Nb(5),s.Ac("disabled",i.row.data)("matTooltip",i.selectedBranchText)("ngModel",i.selectedBranch),s.Nb(1),s.Ac("ngForOf",i.branchList),s.Nb(5),s.Ac("disabled",i.row.data)("matTooltip",i.selectedBranchText)("ngModel",i.selectedCategory),s.Nb(1),s.Ac("ngForOf",i.categoryList),s.Nb(3),s.Ac("rows",i.serviceList)("columns",i.columns)("columnMode","force")("headerHeight",50))},directives:[a.h,_.a,V.c,V.d,V.a,T.c,T.g,G.a,z.a,v.o,v.r,c.k,a.e,f.b,a.c,m.a,F.m,c.l,P.a,U.a,I.b,v.t,v.c,k.c,k.a],styles:[".bb-1[_ngcontent-%COMP%]{border-bottom:1px solid}  .timepicker .clock-face__clock-hand,   .timepicker .clock-face__clock-hand:after,   .timepicker .timepicker__header{background-color:#00546b!important}  .timepicker .clock-face__clock-hand:before{border-color:#00546b!important}  .timepicker .clock-face__number>span.active{background-color:#00546b!important}  .timepicker button:not(.timepicker-dial__item){color:#00546b!important}"]}),e})();var Le=t("VxG0"),Ee=t("R3N2");const Re=[{path:"list",component:(()=>{class e{constructor(e,i,t,c){this.permissionService=e,this.initializeService=i,this.headerService=t,this.authService=c,this.filterComponent=u.a,this.subscriptions=[],this.filter=null,this.dialogSize={width:"80%"},this.columns=[{prop:"branch.branchName",name:"Branch"},{prop:"services.serviceName",name:"Service"},{prop:"servicePersonLevelBooking",name:"Person Level Booking"},{prop:"numberOfBookingAllowed",name:"Booking Allowed"},{prop:"servicePersonStartTime",name:"Start Time"},{prop:"servicePersonEndTime",name:"End Time"}],this.actionButtons=[{type:"Info",matTooltip:this.moduleKeyModel.mapping.name+" Info",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"info",dialogComponent:p,hasPermission:this.permissionService.hasPermission("Info")},{type:"New",matTooltip:"New "+this.moduleKeyModel.mapping.name,matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"add",dialogComponent:ye,hasPermission:this.permissionService.hasPermission("New")},{type:"Edit",matTooltip:this.moduleKeyModel.mapping.name+" Edit",matTooltipClass:"tooltip",matTooltipPosition:"above",color:"primary",matIcon:"edit",dialogComponent:ye,hasPermission:this.permissionService.hasPermission("Edit")}],this.headerService.toggleSpinner(!0),this.subscriptions.push(this.initializeService.initializeCompleted$.subscribe(e=>{e&&(this.headerService.toggleSpinner(!1),this.authService.userInfo&&(this.userInfo=this.authService.userInfo,(this.userInfo.userRole.roleName.toUpperCase()===n.a.merchantAdmin||this.userInfo.userRole.roleName.toUpperCase()===n.a.branchAdmin)&&(this.filter="branch.merchantBean.merchantId=="+this.userInfo.merchant.merchantId)))}))}ngOnInit(){}get moduleKeyModel(){return r.a}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(i){return new(i||e)(s.Zb(Le.a),s.Zb(q.a),s.Zb(O.a),s.Zb(W.a))},e.\u0275cmp=s.Tb({type:e,selectors:[["app-mapping-list"]],decls:1,vars:7,consts:[[3,"inSection","inColumns","inactionButtons","inDialogSize","moduleDisplayName","filterSction","inListFilter"]],template:function(e,i){1&e&&s.ac(0,"app-manage-grid",0),2&e&&s.Ac("inSection",i.moduleKeyModel.mapping.key)("inColumns",i.columns)("inactionButtons",i.actionButtons)("inDialogSize",i.dialogSize)("moduleDisplayName",i.moduleKeyModel.mapping.name)("filterSction",i.filterComponent)("inListFilter",i.filter)},directives:[Ee.a],styles:[""]}),e})()}];let xe=(()=>{class e{}return e.\u0275mod=s.Xb({type:e}),e.\u0275inj=s.Wb({factory:function(i){return new(i||e)},imports:[[o.e.forChild(Re)],o.e]}),e})();var Ye=t("pKmL"),De=t("rsRi"),Oe=t("u9T3");let Ze=(()=>{class e{}return e.\u0275mod=s.Xb({type:e}),e.\u0275inj=s.Wb({factory:function(i){return new(i||e)},imports:[[c.c,xe,Ye.a,De.a,v.j,v.u,f.c,k.b,Oe.a],k.b]}),e})()}}]);